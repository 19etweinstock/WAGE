2022-01-22 1624
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

loops = 2
Epoch = 50
batchSize = 50

lr_schedule = [0, 1., 20, 0.5, 35, 0.25]

# loadModel = None
loadModel = '2022-01-21 1844(MNIST 1288 8 [0, 1.0, 20, 0.5, 35, 0.25] 50 50)'

[[0, 20, 35], [1.0, 1.0, 0.5, 0.25]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
conv/qconv2d [5, 5, 1, 6] Scale: 4
conv/qconv2d_1 [5, 5, 6, 8] Scale: 8
fc/qfc [128, 120] Scale: 8
fc/qfc_1 [120, 84] Scale: 8
fc/qfc_2 [84, 10] Scale: 8
CONV: 1350 FC: 26280 TOTAL: 27630
Epoch 1/50
1200/1200 [==============================] - 14s 10ms/step - loss: 3.2612 - accuracy: 0.9590 - val_loss: 14.2681 - val_accuracy: 0.9631
Epoch 2/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1892 - accuracy: 0.9592 - val_loss: 15.1961 - val_accuracy: 0.9639
Epoch 3/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2177 - accuracy: 0.9589 - val_loss: 16.2908 - val_accuracy: 0.9595
Epoch 4/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3461 - accuracy: 0.9576 - val_loss: 21.8379 - val_accuracy: 0.9462
Epoch 5/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1352 - accuracy: 0.9598 - val_loss: 14.4892 - val_accuracy: 0.9628
Epoch 6/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.3340 - accuracy: 0.9577 - val_loss: 18.3594 - val_accuracy: 0.9547
Epoch 7/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1955 - accuracy: 0.9598 - val_loss: 15.0617 - val_accuracy: 0.9623
Epoch 8/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2973 - accuracy: 0.9585 - val_loss: 22.1010 - val_accuracy: 0.9459
Epoch 9/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2709 - accuracy: 0.9586 - val_loss: 16.1977 - val_accuracy: 0.9593
Epoch 10/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1611 - accuracy: 0.9606 - val_loss: 15.5981 - val_accuracy: 0.9624
Epoch 11/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2116 - accuracy: 0.9593 - val_loss: 14.5906 - val_accuracy: 0.9652
Epoch 12/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2824 - accuracy: 0.9586 - val_loss: 15.6989 - val_accuracy: 0.9611
Epoch 13/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2378 - accuracy: 0.9595 - val_loss: 15.9526 - val_accuracy: 0.9618
Epoch 14/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2779 - accuracy: 0.9582 - val_loss: 16.7671 - val_accuracy: 0.9597
Epoch 15/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2201 - accuracy: 0.9588 - val_loss: 14.1730 - val_accuracy: 0.9636
Epoch 16/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2256 - accuracy: 0.9589 - val_loss: 14.4317 - val_accuracy: 0.9654
Epoch 17/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.0841 - accuracy: 0.9612 - val_loss: 18.5098 - val_accuracy: 0.9538
Epoch 18/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1942 - accuracy: 0.9590 - val_loss: 15.4918 - val_accuracy: 0.9607
Epoch 19/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3182 - accuracy: 0.9579 - val_loss: 21.5267 - val_accuracy: 0.9462
Epoch 20/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2689 - accuracy: 0.9583 - val_loss: 15.0034 - val_accuracy: 0.9646
Epoch 21/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2418 - accuracy: 0.9589 - val_loss: 15.7564 - val_accuracy: 0.9610
Epoch 22/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2433 - accuracy: 0.9590 - val_loss: 17.0550 - val_accuracy: 0.9579
Epoch 23/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2418 - accuracy: 0.9589 - val_loss: 15.0347 - val_accuracy: 0.9614
Epoch 24/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1562 - accuracy: 0.9600 - val_loss: 18.1974 - val_accuracy: 0.9534
Epoch 25/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1588 - accuracy: 0.9598 - val_loss: 13.3490 - val_accuracy: 0.9678
Epoch 26/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1555 - accuracy: 0.9600 - val_loss: 13.6057 - val_accuracy: 0.9662
Epoch 27/50
1200/1200 [==============================] - 14s 11ms/step - loss: 3.1413 - accuracy: 0.9601 - val_loss: 15.0495 - val_accuracy: 0.9621
Epoch 28/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1732 - accuracy: 0.9593 - val_loss: 15.3176 - val_accuracy: 0.9606
Epoch 29/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2664 - accuracy: 0.9583 - val_loss: 15.6813 - val_accuracy: 0.9626
Epoch 30/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1663 - accuracy: 0.9597 - val_loss: 16.0930 - val_accuracy: 0.9596
Epoch 31/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3297 - accuracy: 0.9575 - val_loss: 17.6666 - val_accuracy: 0.9550
Epoch 32/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3153 - accuracy: 0.9574 - val_loss: 14.6154 - val_accuracy: 0.9638
Epoch 33/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3061 - accuracy: 0.9578 - val_loss: 13.9876 - val_accuracy: 0.9653
Epoch 34/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2393 - accuracy: 0.9579 - val_loss: 15.0008 - val_accuracy: 0.9641
Epoch 35/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2382 - accuracy: 0.9585 - val_loss: 16.1455 - val_accuracy: 0.9606
Epoch 36/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1530 - accuracy: 0.9596 - val_loss: 16.4524 - val_accuracy: 0.9589
Epoch 37/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1199 - accuracy: 0.9603 - val_loss: 22.7484 - val_accuracy: 0.9427
Epoch 38/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1898 - accuracy: 0.9593 - val_loss: 15.1895 - val_accuracy: 0.9627
Epoch 39/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2063 - accuracy: 0.9591 - val_loss: 19.4265 - val_accuracy: 0.9503
Epoch 40/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1152 - accuracy: 0.9606 - val_loss: 16.3349 - val_accuracy: 0.9600
Epoch 41/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1150 - accuracy: 0.9599 - val_loss: 14.6620 - val_accuracy: 0.9636
Epoch 42/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.0434 - accuracy: 0.9610 - val_loss: 17.0685 - val_accuracy: 0.9577
Epoch 43/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1644 - accuracy: 0.9602 - val_loss: 15.4635 - val_accuracy: 0.9605
Epoch 44/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1158 - accuracy: 0.9605 - val_loss: 15.5793 - val_accuracy: 0.9615
Epoch 45/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2755 - accuracy: 0.9579 - val_loss: 17.1096 - val_accuracy: 0.9578
Epoch 46/50
1200/1200 [==============================] - 13s 10ms/step - loss: 3.3093 - accuracy: 0.9581 - val_loss: 15.6946 - val_accuracy: 0.9614
Epoch 47/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2194 - accuracy: 0.9592 - val_loss: 15.0264 - val_accuracy: 0.9614
Epoch 48/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2064 - accuracy: 0.9593 - val_loss: 21.2518 - val_accuracy: 0.9463
Epoch 49/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2772 - accuracy: 0.9584 - val_loss: 14.4436 - val_accuracy: 0.9630
Epoch 50/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1907 - accuracy: 0.9595 - val_loss: 15.8194 - val_accuracy: 0.9596
40/40 [==============================] - 0s 4ms/step - loss: 13.3490 - accuracy: 0.9678
235/235 [==============================] - 1s 4ms/step - loss: 13.5908 - accuracy: 0.9663
Epoch 1/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2705 - accuracy: 0.9583 - val_loss: 16.5968 - val_accuracy: 0.9587
Epoch 2/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3313 - accuracy: 0.9577 - val_loss: 14.7788 - val_accuracy: 0.9640
Epoch 3/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.0480 - accuracy: 0.9610 - val_loss: 16.7036 - val_accuracy: 0.9583
Epoch 4/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2731 - accuracy: 0.9580 - val_loss: 15.4050 - val_accuracy: 0.9615
Epoch 5/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3632 - accuracy: 0.9571 - val_loss: 14.7733 - val_accuracy: 0.9637
Epoch 6/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2311 - accuracy: 0.9594 - val_loss: 15.5177 - val_accuracy: 0.9608
Epoch 7/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2805 - accuracy: 0.9582 - val_loss: 15.7333 - val_accuracy: 0.9598
Epoch 8/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2784 - accuracy: 0.9584 - val_loss: 17.0106 - val_accuracy: 0.9574
Epoch 9/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2262 - accuracy: 0.9587 - val_loss: 16.0510 - val_accuracy: 0.9607
Epoch 10/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3168 - accuracy: 0.9575 - val_loss: 17.8363 - val_accuracy: 0.9562
Epoch 11/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3497 - accuracy: 0.9575 - val_loss: 14.9698 - val_accuracy: 0.9629
Epoch 12/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2422 - accuracy: 0.9587 - val_loss: 15.8871 - val_accuracy: 0.9602
Epoch 13/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3838 - accuracy: 0.9571 - val_loss: 15.8108 - val_accuracy: 0.9613
Epoch 14/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2338 - accuracy: 0.9591 - val_loss: 18.1589 - val_accuracy: 0.9553
Epoch 15/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1943 - accuracy: 0.9591 - val_loss: 17.5120 - val_accuracy: 0.9565
Epoch 16/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3635 - accuracy: 0.9570 - val_loss: 15.8394 - val_accuracy: 0.9588
Epoch 17/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2860 - accuracy: 0.9582 - val_loss: 22.3653 - val_accuracy: 0.9440
Epoch 18/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1927 - accuracy: 0.9591 - val_loss: 14.6211 - val_accuracy: 0.9643
Epoch 19/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1475 - accuracy: 0.9604 - val_loss: 14.9097 - val_accuracy: 0.9640
Epoch 20/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1017 - accuracy: 0.9606 - val_loss: 14.6388 - val_accuracy: 0.9637
Epoch 21/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1885 - accuracy: 0.9598 - val_loss: 19.2118 - val_accuracy: 0.9522
Epoch 22/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2254 - accuracy: 0.9589 - val_loss: 20.9303 - val_accuracy: 0.9462
Epoch 23/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2263 - accuracy: 0.9590 - val_loss: 20.7016 - val_accuracy: 0.9461
Epoch 24/50
1200/1200 [==============================] - 16s 13ms/step - loss: 3.2408 - accuracy: 0.9590 - val_loss: 14.0566 - val_accuracy: 0.9658
Epoch 25/50
1200/1200 [==============================] - 14s 12ms/step - loss: 3.1541 - accuracy: 0.9606 - val_loss: 18.7053 - val_accuracy: 0.9515
Epoch 26/50
1200/1200 [==============================] - 13s 10ms/step - loss: 3.2040 - accuracy: 0.9593 - val_loss: 16.7996 - val_accuracy: 0.9583
Epoch 27/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.0945 - accuracy: 0.9613 - val_loss: 16.4969 - val_accuracy: 0.9587
Epoch 28/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1078 - accuracy: 0.9605 - val_loss: 15.9028 - val_accuracy: 0.9602
Epoch 29/50
1200/1200 [==============================] - 13s 11ms/step - loss: 2.9816 - accuracy: 0.9618 - val_loss: 15.3809 - val_accuracy: 0.9613
Epoch 30/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.0809 - accuracy: 0.9607 - val_loss: 15.2528 - val_accuracy: 0.9619
Epoch 31/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1029 - accuracy: 0.9608 - val_loss: 14.2991 - val_accuracy: 0.9635
Epoch 32/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2135 - accuracy: 0.9590 - val_loss: 14.2664 - val_accuracy: 0.9653
Epoch 33/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1757 - accuracy: 0.9596 - val_loss: 16.9433 - val_accuracy: 0.9578
Epoch 34/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2886 - accuracy: 0.9582 - val_loss: 15.8973 - val_accuracy: 0.9613
Epoch 35/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1053 - accuracy: 0.9608 - val_loss: 15.6152 - val_accuracy: 0.9617
Epoch 36/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1255 - accuracy: 0.9602 - val_loss: 15.4346 - val_accuracy: 0.9616
Epoch 37/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2157 - accuracy: 0.9591 - val_loss: 17.6886 - val_accuracy: 0.9578
Epoch 38/50
1200/1200 [==============================] - 13s 10ms/step - loss: 3.2687 - accuracy: 0.9584 - val_loss: 15.2517 - val_accuracy: 0.9626
Epoch 39/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2044 - accuracy: 0.9593 - val_loss: 16.0117 - val_accuracy: 0.9603
Epoch 40/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2003 - accuracy: 0.9593 - val_loss: 15.7510 - val_accuracy: 0.9599
Epoch 41/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2691 - accuracy: 0.9585 - val_loss: 17.3691 - val_accuracy: 0.9576
Epoch 42/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3631 - accuracy: 0.9572 - val_loss: 15.5330 - val_accuracy: 0.9623
Epoch 43/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2246 - accuracy: 0.9589 - val_loss: 14.7194 - val_accuracy: 0.9641
Epoch 44/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2037 - accuracy: 0.9593 - val_loss: 17.2563 - val_accuracy: 0.9568
Epoch 45/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2280 - accuracy: 0.9590 - val_loss: 15.5800 - val_accuracy: 0.9612
Epoch 46/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2428 - accuracy: 0.9590 - val_loss: 14.1230 - val_accuracy: 0.9645
Epoch 47/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1855 - accuracy: 0.9596 - val_loss: 16.6323 - val_accuracy: 0.9600
Epoch 48/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1454 - accuracy: 0.9600 - val_loss: 18.1428 - val_accuracy: 0.9537
Epoch 49/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2096 - accuracy: 0.9596 - val_loss: 14.1633 - val_accuracy: 0.9632
Epoch 50/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2288 - accuracy: 0.9590 - val_loss: 16.3300 - val_accuracy: 0.9594
40/40 [==============================] - 0s 4ms/step - loss: 13.3490 - accuracy: 0.9678
235/235 [==============================] - 1s 4ms/step - loss: 13.5908 - accuracy: 0.9663
