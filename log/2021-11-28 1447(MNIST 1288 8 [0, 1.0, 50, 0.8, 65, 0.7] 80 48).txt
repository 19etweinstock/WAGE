2021-11-28 1447
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 80
batchSize = 48

lr_schedule = [0, 1., 50, 0.8, 65, 0.7]

[[0, 50, 65], [1.0, 1.0, 0.8, 0.7]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
Epoch 1/80
1250/1250 [==============================] - 14s 10ms/step - loss: 0.0688 - accuracy: 0.4750
Epoch 2/80
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0391 - accuracy: 0.7482
Epoch 3/80
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0275 - accuracy: 0.8314
Epoch 4/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0209 - accuracy: 0.8732
Epoch 5/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0182 - accuracy: 0.8877
Epoch 6/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0162 - accuracy: 0.8991
Epoch 7/80
1250/1250 [==============================] - 11s 9ms/step - loss: 0.0148 - accuracy: 0.9076
Epoch 8/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0144 - accuracy: 0.9089
Epoch 9/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0137 - accuracy: 0.9130
Epoch 10/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0132 - accuracy: 0.9154
Epoch 11/80
1250/1250 [==============================] - 11s 9ms/step - loss: 0.0128 - accuracy: 0.9190
Epoch 12/80
1250/1250 [==============================] - 11s 9ms/step - loss: 0.0127 - accuracy: 0.9198
Epoch 13/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0126 - accuracy: 0.9200
Epoch 14/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0124 - accuracy: 0.9215
Epoch 15/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0117 - accuracy: 0.9260
Epoch 16/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0115 - accuracy: 0.9274
Epoch 17/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0111 - accuracy: 0.9303
Epoch 18/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0108 - accuracy: 0.9322
Epoch 19/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0108 - accuracy: 0.9313
Epoch 20/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0104 - accuracy: 0.9342
Epoch 21/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0106 - accuracy: 0.9321
Epoch 22/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0104 - accuracy: 0.9331
Epoch 23/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0100 - accuracy: 0.9361
Epoch 24/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0099 - accuracy: 0.9372
Epoch 25/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0101 - accuracy: 0.9357
Epoch 26/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0101 - accuracy: 0.9354
Epoch 27/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0100 - accuracy: 0.9360
Epoch 28/80
1250/1250 [==============================] - 11s 9ms/step - loss: 0.0098 - accuracy: 0.9374
Epoch 29/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0096 - accuracy: 0.9396
Epoch 30/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0095 - accuracy: 0.9392
Epoch 31/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0094 - accuracy: 0.9403
Epoch 32/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0094 - accuracy: 0.9414
Epoch 33/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0092 - accuracy: 0.9408
Epoch 34/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0094 - accuracy: 0.9404
Epoch 35/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0095 - accuracy: 0.9387
Epoch 36/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0093 - accuracy: 0.9406
Epoch 37/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0091 - accuracy: 0.9420
Epoch 38/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0089 - accuracy: 0.9432
Epoch 39/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0091 - accuracy: 0.9414
Epoch 40/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0089 - accuracy: 0.9431
Epoch 41/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0089 - accuracy: 0.9431
Epoch 42/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0090 - accuracy: 0.9430
Epoch 43/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0084 - accuracy: 0.9469
Epoch 44/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0091 - accuracy: 0.9413
Epoch 45/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0087 - accuracy: 0.9452
Epoch 46/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0086 - accuracy: 0.9448
Epoch 47/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0088 - accuracy: 0.9436
Epoch 48/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0087 - accuracy: 0.9450
Epoch 49/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0085 - accuracy: 0.9459
Epoch 50/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0087 - accuracy: 0.9451
Epoch 51/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0088 - accuracy: 0.9443
Epoch 52/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0087 - accuracy: 0.9449
Epoch 53/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0088 - accuracy: 0.9440
Epoch 54/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0089 - accuracy: 0.9436
Epoch 55/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0086 - accuracy: 0.9453
Epoch 56/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0088 - accuracy: 0.9438
Epoch 57/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0085 - accuracy: 0.9459
Epoch 58/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0084 - accuracy: 0.9466
Epoch 59/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0083 - accuracy: 0.9477
Epoch 60/80
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0083 - accuracy: 0.9476
Epoch 61/80
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0084 - accuracy: 0.9460
Epoch 62/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0084 - accuracy: 0.9464
Epoch 63/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0082 - accuracy: 0.9483
Epoch 64/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0082 - accuracy: 0.9488
Epoch 65/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0083 - accuracy: 0.9474
Epoch 66/80
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0084 - accuracy: 0.9468
Epoch 67/80
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0083 - accuracy: 0.9469
Epoch 68/80
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0083 - accuracy: 0.9468
Epoch 69/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0084 - accuracy: 0.9456
Epoch 70/80
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0082 - accuracy: 0.9475
Epoch 71/80
1250/1250 [==============================] - 11s 9ms/step - loss: 0.0085 - accuracy: 0.9460
Epoch 72/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0083 - accuracy: 0.9474
Epoch 73/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0082 - accuracy: 0.9476
Epoch 74/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0082 - accuracy: 0.9480
Epoch 75/80
1250/1250 [==============================] - 12s 9ms/step - loss: 0.0080 - accuracy: 0.9489
Epoch 76/80
1250/1250 [==============================] - 11s 9ms/step - loss: 0.0081 - accuracy: 0.9481
Epoch 77/80
1250/1250 [==============================] - 11s 9ms/step - loss: 0.0081 - accuracy: 0.9486
Epoch 78/80
1250/1250 [==============================] - 11s 9ms/step - loss: 0.0080 - accuracy: 0.9484
Epoch 79/80
1250/1250 [==============================] - 11s 9ms/step - loss: 0.0081 - accuracy: 0.9482
Epoch 80/80
1250/1250 [==============================] - 11s 9ms/step - loss: 0.0082 - accuracy: 0.9480
313/313 [==============================] - 1s 4ms/step - loss: 0.0070 - accuracy: 0.9551
1875/1875 [==============================] - 7s 3ms/step - loss: 0.0080 - accuracy: 0.9482
