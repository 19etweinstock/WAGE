2021-11-29 2120
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 70
batchSize = 50

lr_schedule = [0, 1., 20, 0.7, 45, 0.2]

# loadModel = None
loadModel = '2021-11-29 2039(MNIST 1288 8 [0, 1.0, 70, 0.7] 100 50)'

[[0, 20, 45], [1.0, 1.0, 0.7, 0.2]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
conv/qconv2d [5, 5, 1, 6] Scale: 4
conv/qconv2d_1 [5, 5, 6, 8] Scale: 8
fc/qfc [128, 120] Scale: 8
fc/qfc_1 [120, 84] Scale: 8
fc/qfc_2 [84, 10] Scale: 8
CONV: 1350 FC: 26280 TOTAL: 27630
Epoch 1/70
1200/1200 [==============================] - 17s 13ms/step - loss: 3.5332 - accuracy: 0.9554 - val_loss: 18.1100 - val_accuracy: 0.9552
Epoch 2/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.4890 - accuracy: 0.9557 - val_loss: 17.3261 - val_accuracy: 0.9570
Epoch 3/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.4878 - accuracy: 0.9556 - val_loss: 17.7540 - val_accuracy: 0.9570
Epoch 4/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.4592 - accuracy: 0.9568 - val_loss: 18.8585 - val_accuracy: 0.9546
Epoch 5/70
1200/1200 [==============================] - 16s 14ms/step - loss: 3.6248 - accuracy: 0.9537 - val_loss: 18.0165 - val_accuracy: 0.9542
Epoch 6/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6070 - accuracy: 0.9540 - val_loss: 16.8235 - val_accuracy: 0.9573
Epoch 7/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7232 - accuracy: 0.9533 - val_loss: 18.1708 - val_accuracy: 0.9547
Epoch 8/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.5535 - accuracy: 0.9546 - val_loss: 16.8791 - val_accuracy: 0.9576
Epoch 9/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6231 - accuracy: 0.9540 - val_loss: 16.6715 - val_accuracy: 0.9596
Epoch 10/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5669 - accuracy: 0.9542 - val_loss: 17.1860 - val_accuracy: 0.9560
Epoch 11/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.6629 - accuracy: 0.9538 - val_loss: 19.7558 - val_accuracy: 0.9499
Epoch 12/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6669 - accuracy: 0.9532 - val_loss: 16.0410 - val_accuracy: 0.9603
Epoch 13/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.6161 - accuracy: 0.9539 - val_loss: 15.3974 - val_accuracy: 0.9624
Epoch 14/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.6856 - accuracy: 0.9534 - val_loss: 17.6995 - val_accuracy: 0.9563
Epoch 15/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7820 - accuracy: 0.9522 - val_loss: 18.1061 - val_accuracy: 0.9569
Epoch 16/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7028 - accuracy: 0.9527 - val_loss: 15.8734 - val_accuracy: 0.9623
Epoch 17/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7282 - accuracy: 0.9520 - val_loss: 18.7271 - val_accuracy: 0.9530
Epoch 18/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6661 - accuracy: 0.9529 - val_loss: 19.8093 - val_accuracy: 0.9516
Epoch 19/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7107 - accuracy: 0.9523 - val_loss: 17.1090 - val_accuracy: 0.9578
Epoch 20/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7313 - accuracy: 0.9526 - val_loss: 15.7681 - val_accuracy: 0.9621
Epoch 21/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7353 - accuracy: 0.9530 - val_loss: 15.7421 - val_accuracy: 0.9605
Epoch 22/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.8169 - accuracy: 0.9502 - val_loss: 15.2514 - val_accuracy: 0.9629
Epoch 23/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7604 - accuracy: 0.9521 - val_loss: 16.2113 - val_accuracy: 0.9596
Epoch 24/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.8458 - accuracy: 0.9510 - val_loss: 22.0008 - val_accuracy: 0.9472
Epoch 25/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7382 - accuracy: 0.9520 - val_loss: 16.9060 - val_accuracy: 0.9585
Epoch 26/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7494 - accuracy: 0.9526 - val_loss: 19.2361 - val_accuracy: 0.9514
Epoch 27/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.5710 - accuracy: 0.9539 - val_loss: 15.3983 - val_accuracy: 0.9616
Epoch 28/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7279 - accuracy: 0.9524 - val_loss: 16.5664 - val_accuracy: 0.9582
Epoch 29/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.6201 - accuracy: 0.9543 - val_loss: 17.8225 - val_accuracy: 0.9558
Epoch 30/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.6819 - accuracy: 0.9531 - val_loss: 16.2240 - val_accuracy: 0.9598
Epoch 31/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.6640 - accuracy: 0.9534 - val_loss: 16.8573 - val_accuracy: 0.9579
Epoch 32/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.5975 - accuracy: 0.9541 - val_loss: 17.7874 - val_accuracy: 0.9561
Epoch 33/70
1200/1200 [==============================] - 14s 11ms/step - loss: 3.6336 - accuracy: 0.9537 - val_loss: 15.9490 - val_accuracy: 0.9598
Epoch 34/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.5461 - accuracy: 0.9547 - val_loss: 20.1484 - val_accuracy: 0.9483
Epoch 35/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7413 - accuracy: 0.9518 - val_loss: 16.9650 - val_accuracy: 0.9585
Epoch 36/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.6264 - accuracy: 0.9539 - val_loss: 18.9882 - val_accuracy: 0.9511
Epoch 37/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7167 - accuracy: 0.9530 - val_loss: 17.1328 - val_accuracy: 0.9569
Epoch 38/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7328 - accuracy: 0.9524 - val_loss: 16.6197 - val_accuracy: 0.9589
Epoch 39/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7072 - accuracy: 0.9535 - val_loss: 17.4912 - val_accuracy: 0.9550
Epoch 40/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7597 - accuracy: 0.9516 - val_loss: 19.2727 - val_accuracy: 0.9516
Epoch 41/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7392 - accuracy: 0.9526 - val_loss: 21.3090 - val_accuracy: 0.9461
Epoch 42/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6083 - accuracy: 0.9534 - val_loss: 16.9674 - val_accuracy: 0.9555
Epoch 43/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5996 - accuracy: 0.9538 - val_loss: 16.8877 - val_accuracy: 0.9592
Epoch 44/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7239 - accuracy: 0.9523 - val_loss: 17.3180 - val_accuracy: 0.9578
Epoch 45/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6216 - accuracy: 0.9546 - val_loss: 17.5815 - val_accuracy: 0.9560
Epoch 46/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.5834 - accuracy: 0.9543 - val_loss: 17.9568 - val_accuracy: 0.9559
Epoch 47/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6566 - accuracy: 0.9528 - val_loss: 16.9787 - val_accuracy: 0.9565
Epoch 48/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5945 - accuracy: 0.9540 - val_loss: 15.7469 - val_accuracy: 0.9621
Epoch 49/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.6185 - accuracy: 0.9536 - val_loss: 18.4955 - val_accuracy: 0.9550
Epoch 50/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.8078 - accuracy: 0.9516 - val_loss: 17.5016 - val_accuracy: 0.9556
Epoch 51/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.8058 - accuracy: 0.9512 - val_loss: 17.2762 - val_accuracy: 0.9557
Epoch 52/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7486 - accuracy: 0.9522 - val_loss: 15.8715 - val_accuracy: 0.9607
Epoch 53/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6910 - accuracy: 0.9531 - val_loss: 15.2138 - val_accuracy: 0.9612
Epoch 54/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7168 - accuracy: 0.9531 - val_loss: 17.0604 - val_accuracy: 0.9585
Epoch 55/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6821 - accuracy: 0.9539 - val_loss: 16.8518 - val_accuracy: 0.9579
Epoch 56/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7249 - accuracy: 0.9525 - val_loss: 15.9534 - val_accuracy: 0.9607
Epoch 57/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6074 - accuracy: 0.9537 - val_loss: 18.3281 - val_accuracy: 0.9544
Epoch 58/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7437 - accuracy: 0.9516 - val_loss: 15.6640 - val_accuracy: 0.9605
Epoch 59/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7411 - accuracy: 0.9520 - val_loss: 16.7955 - val_accuracy: 0.9585
Epoch 60/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7791 - accuracy: 0.9510 - val_loss: 18.2601 - val_accuracy: 0.9537
Epoch 61/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.8364 - accuracy: 0.9513 - val_loss: 16.6391 - val_accuracy: 0.9591
Epoch 62/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.8759 - accuracy: 0.9505 - val_loss: 17.5213 - val_accuracy: 0.9572
Epoch 63/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.9251 - accuracy: 0.9503 - val_loss: 19.6201 - val_accuracy: 0.9517
Epoch 64/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7038 - accuracy: 0.9519 - val_loss: 17.3061 - val_accuracy: 0.9554
Epoch 65/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.8485 - accuracy: 0.9509 - val_loss: 16.9732 - val_accuracy: 0.9573
Epoch 66/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7708 - accuracy: 0.9523 - val_loss: 15.3020 - val_accuracy: 0.9620
Epoch 67/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.8222 - accuracy: 0.9515 - val_loss: 17.1167 - val_accuracy: 0.9588
Epoch 68/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.8020 - accuracy: 0.9514 - val_loss: 17.3451 - val_accuracy: 0.9564
Epoch 69/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7128 - accuracy: 0.9526 - val_loss: 16.9277 - val_accuracy: 0.9576
Epoch 70/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7953 - accuracy: 0.9511 - val_loss: 17.3271 - val_accuracy: 0.9564
313/313 [==============================] - 2s 5ms/step - loss: 1.9073 - accuracy: 0.9629
1875/1875 [==============================] - 10s 5ms/step - loss: 2.1310 - accuracy: 0.9578
