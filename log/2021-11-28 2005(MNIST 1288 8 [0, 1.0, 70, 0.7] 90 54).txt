2021-11-28 2005
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 90
batchSize = 54

lr_schedule = [0, 1., 70, 0.7]

[[0, 70], [1.0, 1.0, 0.7]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
Epoch 1/90
1112/1112 [==============================] - 13s 10ms/step - loss: 0.0732 - accuracy: 0.4356
Epoch 2/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0431 - accuracy: 0.7161
Epoch 3/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0309 - accuracy: 0.8077
Epoch 4/90
1112/1112 [==============================] - 14s 12ms/step - loss: 0.0249 - accuracy: 0.8446
Epoch 5/90
1112/1112 [==============================] - 15s 14ms/step - loss: 0.0217 - accuracy: 0.8652
Epoch 6/90
1112/1112 [==============================] - 12s 11ms/step - loss: 0.0199 - accuracy: 0.8747
Epoch 7/90
1112/1112 [==============================] - 12s 11ms/step - loss: 0.0179 - accuracy: 0.8884
Epoch 8/90
1112/1112 [==============================] - 12s 11ms/step - loss: 0.0169 - accuracy: 0.8932
Epoch 9/90
1112/1112 [==============================] - 12s 11ms/step - loss: 0.0159 - accuracy: 0.8994
Epoch 10/90
1112/1112 [==============================] - 12s 11ms/step - loss: 0.0153 - accuracy: 0.9030
Epoch 11/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0146 - accuracy: 0.9082
Epoch 12/90
1112/1112 [==============================] - 12s 10ms/step - loss: 0.0144 - accuracy: 0.9080
Epoch 13/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0140 - accuracy: 0.9120
Epoch 14/90
1112/1112 [==============================] - 13s 12ms/step - loss: 0.0131 - accuracy: 0.9173
Epoch 15/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0128 - accuracy: 0.9179
Epoch 16/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0126 - accuracy: 0.9204
Epoch 17/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0123 - accuracy: 0.9215
Epoch 18/90
1112/1112 [==============================] - 12s 10ms/step - loss: 0.0118 - accuracy: 0.9258
Epoch 19/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0114 - accuracy: 0.9274
Epoch 20/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0114 - accuracy: 0.9276
Epoch 21/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0110 - accuracy: 0.9305
Epoch 22/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0109 - accuracy: 0.9299
Epoch 23/90
1112/1112 [==============================] - 12s 11ms/step - loss: 0.0109 - accuracy: 0.9307
Epoch 24/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0107 - accuracy: 0.9320
Epoch 25/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0110 - accuracy: 0.9300
Epoch 26/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0107 - accuracy: 0.9322
Epoch 27/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0103 - accuracy: 0.9349
Epoch 28/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0100 - accuracy: 0.9366
Epoch 29/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0103 - accuracy: 0.9345
Epoch 30/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0102 - accuracy: 0.9348
Epoch 31/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0099 - accuracy: 0.9378
Epoch 32/90
1112/1112 [==============================] - 11s 10ms/step - loss: 0.0099 - accuracy: 0.9366
Epoch 33/90
1112/1112 [==============================] - 12s 10ms/step - loss: 0.0095 - accuracy: 0.9387
Epoch 34/90
   1/1112 [..............................] - ETA: 11s - loss: nan - accuracy: 0.1111Batch 0: Invalid loss, terminating training
1112/1112 [==============================] - 0s 1us/step - loss: nan - accuracy: 0.1111
313/313 [==============================] - 2s 4ms/step - loss: nan - accuracy: 0.0980
1875/1875 [==============================] - 8s 4ms/step - loss: nan - accuracy: 0.0987
