2021-11-29 1033
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 90
batchSize = 48

lr_schedule = [0, 1., 70, 0.7]

loadModel = None
# loadModel = '2021-11-28 2347(MNIST 1288 8 [0, 1.0, 70, 0.7] 90 48)'

[[0, 70], [1.0, 1.0, 0.7]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
Epoch 1/90
1250/1250 [==============================] - 15s 10ms/step - loss: 0.0691 - accuracy: 0.4686
Epoch 2/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0486 - accuracy: 0.6625
Epoch 3/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0403 - accuracy: 0.7254
Epoch 4/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0360 - accuracy: 0.7587
Epoch 5/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0330 - accuracy: 0.7811
Epoch 6/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0319 - accuracy: 0.7900
Epoch 7/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0301 - accuracy: 0.8016
Epoch 8/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0291 - accuracy: 0.8091
Epoch 9/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0284 - accuracy: 0.8124
Epoch 10/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0277 - accuracy: 0.8189
Epoch 11/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0273 - accuracy: 0.8202
Epoch 12/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0267 - accuracy: 0.8262
Epoch 13/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0265 - accuracy: 0.8265
Epoch 14/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0258 - accuracy: 0.8319
Epoch 15/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0257 - accuracy: 0.8309
Epoch 16/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0254 - accuracy: 0.8351
Epoch 17/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0248 - accuracy: 0.8382
Epoch 18/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0249 - accuracy: 0.8374
Epoch 19/90
1250/1250 [==============================] - 17s 13ms/step - loss: 0.0249 - accuracy: 0.8374
Epoch 20/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0245 - accuracy: 0.8419
Epoch 21/90
1250/1250 [==============================] - 29s 23ms/step - loss: 0.0243 - accuracy: 0.8424
Epoch 22/90
1250/1250 [==============================] - 20s 16ms/step - loss: 0.0244 - accuracy: 0.8409
Epoch 23/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0243 - accuracy: 0.8428
Epoch 24/90
1250/1250 [==============================] - 17s 13ms/step - loss: 0.0240 - accuracy: 0.8436
Epoch 25/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0241 - accuracy: 0.8429
Epoch 26/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0242 - accuracy: 0.8434
Epoch 27/90
1250/1250 [==============================] - 16s 13ms/step - loss: 0.0239 - accuracy: 0.8442
Epoch 28/90
1250/1250 [==============================] - 16s 13ms/step - loss: 0.0239 - accuracy: 0.8437
Epoch 29/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0242 - accuracy: 0.8425
Epoch 30/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0241 - accuracy: 0.8439
Epoch 31/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0240 - accuracy: 0.8430
Epoch 32/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0234 - accuracy: 0.8477
Epoch 33/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0234 - accuracy: 0.8483
Epoch 34/90
1250/1250 [==============================] - 20s 16ms/step - loss: 0.0238 - accuracy: 0.8444
Epoch 35/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0233 - accuracy: 0.8484
Epoch 36/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0232 - accuracy: 0.8491
Epoch 37/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0233 - accuracy: 0.8489
Epoch 38/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0232 - accuracy: 0.8496
Epoch 39/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0232 - accuracy: 0.8480
Epoch 40/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0232 - accuracy: 0.8493
Epoch 41/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0226 - accuracy: 0.8522
Epoch 42/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0229 - accuracy: 0.8514
Epoch 43/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0226 - accuracy: 0.8533
Epoch 44/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0226 - accuracy: 0.8516
Epoch 45/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0225 - accuracy: 0.8536
Epoch 46/90
1250/1250 [==============================] - 15s 12ms/step - loss: 0.0228 - accuracy: 0.8521
Epoch 47/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0225 - accuracy: 0.8528
Epoch 48/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0222 - accuracy: 0.8562
Epoch 49/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0221 - accuracy: 0.8565
Epoch 50/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0223 - accuracy: 0.8548
Epoch 51/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0221 - accuracy: 0.8560
Epoch 52/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0222 - accuracy: 0.8547
Epoch 53/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0222 - accuracy: 0.8546
Epoch 54/90
1250/1250 [==============================] - 16s 13ms/step - loss: 0.0224 - accuracy: 0.8547
Epoch 55/90
1250/1250 [==============================] - 15s 12ms/step - loss: 0.0219 - accuracy: 0.8578
Epoch 56/90
1250/1250 [==============================] - 14s 12ms/step - loss: 0.0223 - accuracy: 0.8550
Epoch 57/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0225 - accuracy: 0.8532
Epoch 58/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0218 - accuracy: 0.8572
Epoch 59/90
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0219 - accuracy: 0.8578
Epoch 60/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0215 - accuracy: 0.8601
Epoch 61/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0215 - accuracy: 0.8603
Epoch 62/90
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0213 - accuracy: 0.8614
Epoch 63/90
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0218 - accuracy: 0.8591
Epoch 64/90
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0213 - accuracy: 0.8608
Epoch 65/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0212 - accuracy: 0.8624
Epoch 66/90
1250/1250 [==============================] - 15s 12ms/step - loss: 0.0215 - accuracy: 0.8600
Epoch 67/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0214 - accuracy: 0.8607
Epoch 68/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0218 - accuracy: 0.8598
Epoch 69/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0214 - accuracy: 0.8609
Epoch 70/90
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0217 - accuracy: 0.8600
Epoch 71/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0217 - accuracy: 0.8602
Epoch 72/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0218 - accuracy: 0.8596
Epoch 73/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0219 - accuracy: 0.8585
Epoch 74/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0215 - accuracy: 0.8607
Epoch 75/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0215 - accuracy: 0.8611
Epoch 76/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0211 - accuracy: 0.8621
Epoch 77/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0213 - accuracy: 0.8615
Epoch 78/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0214 - accuracy: 0.8620
Epoch 79/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0213 - accuracy: 0.8613
Epoch 80/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0210 - accuracy: 0.8637
Epoch 81/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0210 - accuracy: 0.8637
Epoch 82/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0211 - accuracy: 0.8637
Epoch 83/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0214 - accuracy: 0.8597
Epoch 84/90
1250/1250 [==============================] - 13s 10ms/step - loss: 0.0211 - accuracy: 0.8644
Epoch 85/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0213 - accuracy: 0.8620
Epoch 86/90
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0209 - accuracy: 0.8626
Epoch 87/90
1250/1250 [==============================] - 12s 10ms/step - loss: 0.0212 - accuracy: 0.8626
Epoch 88/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0211 - accuracy: 0.8636
Epoch 89/90
1250/1250 [==============================] - 14s 11ms/step - loss: 0.0207 - accuracy: 0.8661
Epoch 90/90
1250/1250 [==============================] - 13s 11ms/step - loss: 0.0210 - accuracy: 0.8639
313/313 [==============================] - 2s 4ms/step - loss: 0.0204 - accuracy: 0.8680
1875/1875 [==============================] - 8s 4ms/step - loss: 0.0212 - accuracy: 0.8607
