2021-11-29 2158
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 70
batchSize = 50

lr_schedule = [0, 1., 20, 0.7, 45, 0.2]

# loadModel = None
loadModel = '2021-11-29 2139(MNIST 1288 8 [0, 1.0, 20, 0.7, 45, 0.2] 70 50)'

[[0, 20, 45], [1.0, 1.0, 0.7, 0.2]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
conv/qconv2d [5, 5, 1, 6] Scale: 4
conv/qconv2d_1 [5, 5, 6, 8] Scale: 8
fc/qfc [128, 120] Scale: 8
fc/qfc_1 [120, 84] Scale: 8
fc/qfc_2 [84, 10] Scale: 8
CONV: 1350 FC: 26280 TOTAL: 27630
Epoch 1/70
1200/1200 [==============================] - 17s 13ms/step - loss: 3.6152 - accuracy: 0.9542 - val_loss: 18.3913 - val_accuracy: 0.9551
Epoch 2/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6380 - accuracy: 0.9535 - val_loss: 18.2556 - val_accuracy: 0.9544
Epoch 3/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6783 - accuracy: 0.9528 - val_loss: 15.1928 - val_accuracy: 0.9611
Epoch 4/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7159 - accuracy: 0.9525 - val_loss: 17.7249 - val_accuracy: 0.9546
Epoch 5/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6882 - accuracy: 0.9534 - val_loss: 17.6478 - val_accuracy: 0.9561
Epoch 6/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6902 - accuracy: 0.9531 - val_loss: 16.9319 - val_accuracy: 0.9603
Epoch 7/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7611 - accuracy: 0.9517 - val_loss: 16.9658 - val_accuracy: 0.9586
Epoch 8/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6814 - accuracy: 0.9536 - val_loss: 18.0537 - val_accuracy: 0.9544
Epoch 9/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7676 - accuracy: 0.9518 - val_loss: 19.1828 - val_accuracy: 0.9520
Epoch 10/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7066 - accuracy: 0.9530 - val_loss: 18.4775 - val_accuracy: 0.9521
Epoch 11/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.8828 - accuracy: 0.9504 - val_loss: 18.0819 - val_accuracy: 0.9551
Epoch 12/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.6488 - accuracy: 0.9535 - val_loss: 20.0746 - val_accuracy: 0.9477
Epoch 13/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6697 - accuracy: 0.9525 - val_loss: 17.0704 - val_accuracy: 0.9578
Epoch 14/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6454 - accuracy: 0.9536 - val_loss: 18.9468 - val_accuracy: 0.9523
Epoch 15/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6480 - accuracy: 0.9536 - val_loss: 16.7744 - val_accuracy: 0.9571
Epoch 16/70
1200/1200 [==============================] - 16s 14ms/step - loss: 3.6166 - accuracy: 0.9540 - val_loss: 20.7010 - val_accuracy: 0.9458
Epoch 17/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5291 - accuracy: 0.9550 - val_loss: 15.9574 - val_accuracy: 0.9593
Epoch 18/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6930 - accuracy: 0.9533 - val_loss: 20.7176 - val_accuracy: 0.9501
Epoch 19/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.5597 - accuracy: 0.9549 - val_loss: 16.8399 - val_accuracy: 0.9589
Epoch 20/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7296 - accuracy: 0.9512 - val_loss: 19.8829 - val_accuracy: 0.9511
Epoch 21/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6322 - accuracy: 0.9538 - val_loss: 14.6854 - val_accuracy: 0.9637
Epoch 22/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6915 - accuracy: 0.9533 - val_loss: 17.7132 - val_accuracy: 0.9575
Epoch 23/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.5813 - accuracy: 0.9543 - val_loss: 16.5831 - val_accuracy: 0.9594
Epoch 24/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.6833 - accuracy: 0.9535 - val_loss: 17.5739 - val_accuracy: 0.9572
Epoch 25/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6390 - accuracy: 0.9537 - val_loss: 17.5245 - val_accuracy: 0.9561
Epoch 26/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.6351 - accuracy: 0.9540 - val_loss: 16.7330 - val_accuracy: 0.9591
Epoch 27/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7609 - accuracy: 0.9519 - val_loss: 16.1992 - val_accuracy: 0.9602
Epoch 28/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.5431 - accuracy: 0.9546 - val_loss: 16.1024 - val_accuracy: 0.9600
Epoch 29/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.5876 - accuracy: 0.9541 - val_loss: 16.6291 - val_accuracy: 0.9589
Epoch 30/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6866 - accuracy: 0.9528 - val_loss: 18.6185 - val_accuracy: 0.9545
Epoch 31/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5842 - accuracy: 0.9543 - val_loss: 18.7877 - val_accuracy: 0.9537
Epoch 32/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5726 - accuracy: 0.9540 - val_loss: 16.1079 - val_accuracy: 0.9597
Epoch 33/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.4870 - accuracy: 0.9562 - val_loss: 15.3803 - val_accuracy: 0.9621
Epoch 34/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5509 - accuracy: 0.9553 - val_loss: 17.0690 - val_accuracy: 0.9572
Epoch 35/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6536 - accuracy: 0.9537 - val_loss: 18.1432 - val_accuracy: 0.9550
Epoch 36/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7499 - accuracy: 0.9519 - val_loss: 17.9578 - val_accuracy: 0.9538
Epoch 37/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.6156 - accuracy: 0.9546 - val_loss: 19.1927 - val_accuracy: 0.9531
Epoch 38/70
1200/1200 [==============================] - 13s 11ms/step - loss: 3.6531 - accuracy: 0.9532 - val_loss: 17.2528 - val_accuracy: 0.9558
Epoch 39/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6697 - accuracy: 0.9537 - val_loss: 15.0368 - val_accuracy: 0.9634
Epoch 40/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6537 - accuracy: 0.9532 - val_loss: 17.5452 - val_accuracy: 0.9564
Epoch 41/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6173 - accuracy: 0.9531 - val_loss: 16.7602 - val_accuracy: 0.9565
Epoch 42/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6014 - accuracy: 0.9553 - val_loss: 16.4601 - val_accuracy: 0.9600
Epoch 43/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5633 - accuracy: 0.9548 - val_loss: 16.0707 - val_accuracy: 0.9611
Epoch 44/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6804 - accuracy: 0.9527 - val_loss: 18.7440 - val_accuracy: 0.9529
Epoch 45/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6777 - accuracy: 0.9528 - val_loss: 17.5039 - val_accuracy: 0.9587
Epoch 46/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7187 - accuracy: 0.9527 - val_loss: 18.0418 - val_accuracy: 0.9546
Epoch 47/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7702 - accuracy: 0.9514 - val_loss: 19.0251 - val_accuracy: 0.9521
Epoch 48/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5901 - accuracy: 0.9541 - val_loss: 21.2698 - val_accuracy: 0.9478
Epoch 49/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5931 - accuracy: 0.9542 - val_loss: 17.0495 - val_accuracy: 0.9575
Epoch 50/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.5960 - accuracy: 0.9538 - val_loss: 19.2622 - val_accuracy: 0.9516
Epoch 51/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6078 - accuracy: 0.9544 - val_loss: 15.8433 - val_accuracy: 0.9597
Epoch 52/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7396 - accuracy: 0.9527 - val_loss: 15.9038 - val_accuracy: 0.9604
Epoch 53/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6580 - accuracy: 0.9535 - val_loss: 18.7547 - val_accuracy: 0.9519
Epoch 54/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6170 - accuracy: 0.9532 - val_loss: 16.5716 - val_accuracy: 0.9599
Epoch 55/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7367 - accuracy: 0.9524 - val_loss: 16.6513 - val_accuracy: 0.9582
Epoch 56/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5945 - accuracy: 0.9537 - val_loss: 18.5998 - val_accuracy: 0.9535
Epoch 57/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5868 - accuracy: 0.9550 - val_loss: 17.9473 - val_accuracy: 0.9565
Epoch 58/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5432 - accuracy: 0.9554 - val_loss: 17.4865 - val_accuracy: 0.9557
Epoch 59/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6346 - accuracy: 0.9538 - val_loss: 16.2621 - val_accuracy: 0.9616
Epoch 60/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6144 - accuracy: 0.9538 - val_loss: 16.1441 - val_accuracy: 0.9598
Epoch 61/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5772 - accuracy: 0.9539 - val_loss: 15.8760 - val_accuracy: 0.9605
Epoch 62/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6602 - accuracy: 0.9537 - val_loss: 18.1958 - val_accuracy: 0.9565
Epoch 63/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6794 - accuracy: 0.9529 - val_loss: 15.7465 - val_accuracy: 0.9593
Epoch 64/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5264 - accuracy: 0.9558 - val_loss: 18.9741 - val_accuracy: 0.9538
Epoch 65/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.5217 - accuracy: 0.9557 - val_loss: 17.7243 - val_accuracy: 0.9569
Epoch 66/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.5397 - accuracy: 0.9549 - val_loss: 16.5045 - val_accuracy: 0.9585
Epoch 67/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7230 - accuracy: 0.9524 - val_loss: 18.8397 - val_accuracy: 0.9518
Epoch 68/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7308 - accuracy: 0.9529 - val_loss: 15.5979 - val_accuracy: 0.9598
Epoch 69/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7172 - accuracy: 0.9526 - val_loss: 17.5914 - val_accuracy: 0.9559
Epoch 70/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7159 - accuracy: 0.9525 - val_loss: 21.3391 - val_accuracy: 0.9467
313/313 [==============================] - 2s 5ms/step - loss: 1.8358 - accuracy: 0.9637
1875/1875 [==============================] - 9s 5ms/step - loss: 1.9573 - accuracy: 0.9612
