2021-11-28 1602
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 110
batchSize = 64

lr_schedule = [0, 1., 70, 0.7, 100, 0.5]

[[0, 70, 100], [1.0, 1.0, 0.7, 0.5]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
Epoch 1/110
938/938 [==============================] - 10s 9ms/step - loss: 0.0771 - accuracy: 0.3949
Epoch 2/110
938/938 [==============================] - 9s 9ms/step - loss: 0.0543 - accuracy: 0.6200
Epoch 3/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0417 - accuracy: 0.7258
Epoch 4/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0338 - accuracy: 0.7842
Epoch 5/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0287 - accuracy: 0.8172
Epoch 6/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0257 - accuracy: 0.8392
Epoch 7/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0232 - accuracy: 0.8547
Epoch 8/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0208 - accuracy: 0.8687
Epoch 9/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0188 - accuracy: 0.8816
Epoch 10/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0177 - accuracy: 0.8893
Epoch 11/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0166 - accuracy: 0.8964
Epoch 12/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0161 - accuracy: 0.8980
Epoch 13/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0155 - accuracy: 0.9022
Epoch 14/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0148 - accuracy: 0.9067
Epoch 15/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0143 - accuracy: 0.9098
Epoch 16/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0140 - accuracy: 0.9115
Epoch 17/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0135 - accuracy: 0.9141
Epoch 18/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0135 - accuracy: 0.9142
Epoch 19/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0130 - accuracy: 0.9168
Epoch 20/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0129 - accuracy: 0.9172
Epoch 21/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0125 - accuracy: 0.9207
Epoch 22/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0126 - accuracy: 0.9194
Epoch 23/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0122 - accuracy: 0.9229
Epoch 24/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0120 - accuracy: 0.9236
Epoch 25/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0118 - accuracy: 0.9251
Epoch 26/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0112 - accuracy: 0.9294
Epoch 27/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0115 - accuracy: 0.9263
Epoch 28/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0110 - accuracy: 0.9297
Epoch 29/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0114 - accuracy: 0.9276
Epoch 30/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0112 - accuracy: 0.9284
Epoch 31/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0113 - accuracy: 0.9283
Epoch 32/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0113 - accuracy: 0.9274
Epoch 33/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0110 - accuracy: 0.9297
Epoch 34/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0111 - accuracy: 0.9294
Epoch 35/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0108 - accuracy: 0.9311
Epoch 36/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0104 - accuracy: 0.9333
Epoch 37/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0105 - accuracy: 0.9337
Epoch 38/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0103 - accuracy: 0.9346
Epoch 39/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0102 - accuracy: 0.9351
Epoch 40/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0101 - accuracy: 0.9361
Epoch 41/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0100 - accuracy: 0.9359
Epoch 42/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0102 - accuracy: 0.9343
Epoch 43/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0102 - accuracy: 0.9351
Epoch 44/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0104 - accuracy: 0.9339
Epoch 45/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0102 - accuracy: 0.9347
Epoch 46/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0102 - accuracy: 0.9352
Epoch 47/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0101 - accuracy: 0.9360
Epoch 48/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0103 - accuracy: 0.9348
Epoch 49/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0096 - accuracy: 0.9393
Epoch 50/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0096 - accuracy: 0.9393
Epoch 51/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0099 - accuracy: 0.9373
Epoch 52/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0097 - accuracy: 0.9382
Epoch 53/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0094 - accuracy: 0.9401
Epoch 54/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0093 - accuracy: 0.9406
Epoch 55/110
938/938 [==============================] - 11s 12ms/step - loss: 0.0095 - accuracy: 0.9393
Epoch 56/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0093 - accuracy: 0.9413
Epoch 57/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0095 - accuracy: 0.9400
Epoch 58/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0096 - accuracy: 0.9389
Epoch 59/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0093 - accuracy: 0.9407
Epoch 60/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0093 - accuracy: 0.9410
Epoch 61/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0096 - accuracy: 0.9391
Epoch 62/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0092 - accuracy: 0.9410
Epoch 63/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0091 - accuracy: 0.9420
Epoch 64/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0090 - accuracy: 0.9424
Epoch 65/110
938/938 [==============================] - 12s 13ms/step - loss: 0.0091 - accuracy: 0.9422
Epoch 66/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0092 - accuracy: 0.9418
Epoch 67/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0091 - accuracy: 0.9420
Epoch 68/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0090 - accuracy: 0.9421
Epoch 69/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0089 - accuracy: 0.9431
Epoch 70/110
938/938 [==============================] - 11s 11ms/step - loss: 0.0090 - accuracy: 0.9422
Epoch 71/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0089 - accuracy: 0.9435
Epoch 72/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0087 - accuracy: 0.9442
Epoch 73/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0089 - accuracy: 0.9432
Epoch 74/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0086 - accuracy: 0.9453
Epoch 75/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0085 - accuracy: 0.9454
Epoch 76/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0083 - accuracy: 0.9465
Epoch 77/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0083 - accuracy: 0.9466
Epoch 78/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0083 - accuracy: 0.9478
Epoch 79/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0083 - accuracy: 0.9476
Epoch 80/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0080 - accuracy: 0.9496
Epoch 81/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0083 - accuracy: 0.9468
Epoch 82/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0082 - accuracy: 0.9480
Epoch 83/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0082 - accuracy: 0.9488
Epoch 84/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0083 - accuracy: 0.9479
Epoch 85/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0080 - accuracy: 0.9488
Epoch 86/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0083 - accuracy: 0.9473
Epoch 87/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0084 - accuracy: 0.9470
Epoch 88/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0082 - accuracy: 0.9473
Epoch 89/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0080 - accuracy: 0.9489
Epoch 90/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0079 - accuracy: 0.9495
Epoch 91/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0081 - accuracy: 0.9486
Epoch 92/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0078 - accuracy: 0.9505
Epoch 93/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0080 - accuracy: 0.9491
Epoch 94/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0080 - accuracy: 0.9482
Epoch 95/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0081 - accuracy: 0.9482
Epoch 96/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0079 - accuracy: 0.9493
Epoch 97/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0079 - accuracy: 0.9495
Epoch 98/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0076 - accuracy: 0.9518
Epoch 99/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0079 - accuracy: 0.9496
Epoch 100/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0077 - accuracy: 0.9513
Epoch 101/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0079 - accuracy: 0.9498
Epoch 102/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0078 - accuracy: 0.9503
Epoch 103/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0075 - accuracy: 0.9523
Epoch 104/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0077 - accuracy: 0.9501
Epoch 105/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0078 - accuracy: 0.9504
Epoch 106/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0080 - accuracy: 0.9492
Epoch 107/110
938/938 [==============================] - 10s 11ms/step - loss: 0.0076 - accuracy: 0.9513
Epoch 108/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0078 - accuracy: 0.9498
Epoch 109/110
938/938 [==============================] - 9s 10ms/step - loss: 0.0077 - accuracy: 0.9509
Epoch 110/110
938/938 [==============================] - 10s 10ms/step - loss: 0.0079 - accuracy: 0.9501
313/313 [==============================] - 1s 4ms/step - loss: 0.0089 - accuracy: 0.9459
1875/1875 [==============================] - 7s 3ms/step - loss: 0.0093 - accuracy: 0.9409
