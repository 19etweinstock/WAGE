2021-11-29 2039
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 100
batchSize = 50

lr_schedule = [0, 1., 70, 0.7]

loadModel = None
# loadModel = '2021-11-29 1055(MNIST 1288 8 [0, 1.0, 70, 0.7] 90 50)'

[[0, 70], [1.0, 1.0, 0.7]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
conv/qconv2d [5, 5, 1, 6] Scale: 4
conv/qconv2d_1 [5, 5, 6, 8] Scale: 8
fc/qfc [128, 120] Scale: 8
fc/qfc_1 [120, 84] Scale: 8
fc/qfc_2 [84, 10] Scale: 8
CONV: 1350 FC: 26280 TOTAL: 27630
Epoch 1/100
1200/1200 [==============================] - 14s 11ms/step - loss: 38.3567 - accuracy: 0.3971 - val_loss: 144.3253 - val_accuracy: 0.6037
Epoch 2/100
1200/1200 [==============================] - 13s 11ms/step - loss: 22.0549 - accuracy: 0.7097 - val_loss: 96.7793 - val_accuracy: 0.7486
Epoch 3/100
1200/1200 [==============================] - 13s 11ms/step - loss: 14.8238 - accuracy: 0.8157 - val_loss: 60.9172 - val_accuracy: 0.8544
Epoch 4/100
1200/1200 [==============================] - 13s 11ms/step - loss: 11.7968 - accuracy: 0.8532 - val_loss: 48.1497 - val_accuracy: 0.8850
Epoch 5/100
1200/1200 [==============================] - 13s 11ms/step - loss: 10.1524 - accuracy: 0.8729 - val_loss: 43.2808 - val_accuracy: 0.8960
Epoch 6/100
1200/1200 [==============================] - 13s 11ms/step - loss: 8.6471 - accuracy: 0.8923 - val_loss: 37.7121 - val_accuracy: 0.9089
Epoch 7/100
1200/1200 [==============================] - 13s 11ms/step - loss: 8.0392 - accuracy: 0.8989 - val_loss: 36.1884 - val_accuracy: 0.9126
Epoch 8/100
1200/1200 [==============================] - 13s 11ms/step - loss: 7.3547 - accuracy: 0.9076 - val_loss: 32.6698 - val_accuracy: 0.9198
Epoch 9/100
1200/1200 [==============================] - 13s 11ms/step - loss: 7.0747 - accuracy: 0.9104 - val_loss: 30.7069 - val_accuracy: 0.9234
Epoch 10/100
1200/1200 [==============================] - 13s 11ms/step - loss: 6.9773 - accuracy: 0.9121 - val_loss: 30.0694 - val_accuracy: 0.9262
Epoch 11/100
1200/1200 [==============================] - 13s 11ms/step - loss: 6.4295 - accuracy: 0.9194 - val_loss: 29.0062 - val_accuracy: 0.9281
Epoch 12/100
1200/1200 [==============================] - 14s 11ms/step - loss: 6.3894 - accuracy: 0.9190 - val_loss: 27.7325 - val_accuracy: 0.9333
Epoch 13/100
1200/1200 [==============================] - 13s 11ms/step - loss: 6.2245 - accuracy: 0.9214 - val_loss: 31.1561 - val_accuracy: 0.9239
Epoch 14/100
1200/1200 [==============================] - 13s 11ms/step - loss: 6.1136 - accuracy: 0.9223 - val_loss: 29.3808 - val_accuracy: 0.9253
Epoch 15/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.9867 - accuracy: 0.9237 - val_loss: 28.9481 - val_accuracy: 0.9291
Epoch 16/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.9239 - accuracy: 0.9244 - val_loss: 26.5218 - val_accuracy: 0.9353
Epoch 17/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.9446 - accuracy: 0.9241 - val_loss: 26.7272 - val_accuracy: 0.9343
Epoch 18/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.9396 - accuracy: 0.9246 - val_loss: 26.1513 - val_accuracy: 0.9354
Epoch 19/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.6733 - accuracy: 0.9276 - val_loss: 27.4444 - val_accuracy: 0.9297
Epoch 20/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.4610 - accuracy: 0.9306 - val_loss: 30.6448 - val_accuracy: 0.9221
Epoch 21/100
1200/1200 [==============================] - 13s 10ms/step - loss: 5.4562 - accuracy: 0.9300 - val_loss: 23.5929 - val_accuracy: 0.9401
Epoch 22/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.5329 - accuracy: 0.9286 - val_loss: 24.3529 - val_accuracy: 0.9411
Epoch 23/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.2561 - accuracy: 0.9336 - val_loss: 22.1516 - val_accuracy: 0.9445
Epoch 24/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.3037 - accuracy: 0.9325 - val_loss: 31.3881 - val_accuracy: 0.9211
Epoch 25/100
1200/1200 [==============================] - 13s 10ms/step - loss: 5.4541 - accuracy: 0.9304 - val_loss: 28.8247 - val_accuracy: 0.9261
Epoch 26/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.4674 - accuracy: 0.9295 - val_loss: 22.8296 - val_accuracy: 0.9431
Epoch 27/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.4149 - accuracy: 0.9311 - val_loss: 23.3852 - val_accuracy: 0.9414
Epoch 28/100
1200/1200 [==============================] - 13s 10ms/step - loss: 5.3685 - accuracy: 0.9320 - val_loss: 24.1080 - val_accuracy: 0.9423
Epoch 29/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.1361 - accuracy: 0.9339 - val_loss: 27.2230 - val_accuracy: 0.9331
Epoch 30/100
1200/1200 [==============================] - 13s 10ms/step - loss: 5.2817 - accuracy: 0.9330 - val_loss: 23.8348 - val_accuracy: 0.9412
Epoch 31/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.3921 - accuracy: 0.9313 - val_loss: 22.8156 - val_accuracy: 0.9441
Epoch 32/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.2408 - accuracy: 0.9330 - val_loss: 23.1250 - val_accuracy: 0.9419
Epoch 33/100
1200/1200 [==============================] - 13s 10ms/step - loss: 5.3598 - accuracy: 0.9316 - val_loss: 26.1966 - val_accuracy: 0.9346
Epoch 34/100
1200/1200 [==============================] - 14s 12ms/step - loss: 5.2147 - accuracy: 0.9330 - val_loss: 22.6594 - val_accuracy: 0.9449
Epoch 35/100
1200/1200 [==============================] - 14s 12ms/step - loss: 5.3589 - accuracy: 0.9317 - val_loss: 22.6991 - val_accuracy: 0.9439
Epoch 36/100
1200/1200 [==============================] - 14s 12ms/step - loss: 5.1068 - accuracy: 0.9350 - val_loss: 21.3140 - val_accuracy: 0.9442
Epoch 37/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.1575 - accuracy: 0.9339 - val_loss: 26.9221 - val_accuracy: 0.9329
Epoch 38/100
1200/1200 [==============================] - 13s 11ms/step - loss: 5.0558 - accuracy: 0.9357 - val_loss: 27.3217 - val_accuracy: 0.9325
Epoch 39/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.8613 - accuracy: 0.9375 - val_loss: 24.0287 - val_accuracy: 0.9393
Epoch 40/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.9361 - accuracy: 0.9371 - val_loss: 20.7389 - val_accuracy: 0.9482
Epoch 41/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.9002 - accuracy: 0.9374 - val_loss: 20.5931 - val_accuracy: 0.9506
Epoch 42/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.8577 - accuracy: 0.9388 - val_loss: 23.5622 - val_accuracy: 0.9409
Epoch 43/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.9055 - accuracy: 0.9363 - val_loss: 21.1290 - val_accuracy: 0.9485
Epoch 44/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.7315 - accuracy: 0.9393 - val_loss: 23.2805 - val_accuracy: 0.9407
Epoch 45/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.7828 - accuracy: 0.9389 - val_loss: 20.4337 - val_accuracy: 0.9492
Epoch 46/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.6241 - accuracy: 0.9405 - val_loss: 25.4954 - val_accuracy: 0.9364
Epoch 47/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.5530 - accuracy: 0.9419 - val_loss: 19.4180 - val_accuracy: 0.9536
Epoch 48/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.4425 - accuracy: 0.9430 - val_loss: 19.3789 - val_accuracy: 0.9518
Epoch 49/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.6720 - accuracy: 0.9403 - val_loss: 19.4415 - val_accuracy: 0.9517
Epoch 50/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.4671 - accuracy: 0.9433 - val_loss: 18.8964 - val_accuracy: 0.9518
Epoch 51/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.5400 - accuracy: 0.9415 - val_loss: 21.3022 - val_accuracy: 0.9482
Epoch 52/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.5695 - accuracy: 0.9412 - val_loss: 20.3569 - val_accuracy: 0.9505
Epoch 53/100
1200/1200 [==============================] - 13s 10ms/step - loss: 4.5451 - accuracy: 0.9419 - val_loss: 19.2923 - val_accuracy: 0.9520
Epoch 54/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.3235 - accuracy: 0.9445 - val_loss: 20.6402 - val_accuracy: 0.9490
Epoch 55/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.5263 - accuracy: 0.9419 - val_loss: 19.1888 - val_accuracy: 0.9517
Epoch 56/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.4971 - accuracy: 0.9423 - val_loss: 19.3557 - val_accuracy: 0.9524
Epoch 57/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.4038 - accuracy: 0.9438 - val_loss: 19.4405 - val_accuracy: 0.9508
Epoch 58/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.3863 - accuracy: 0.9439 - val_loss: 17.8273 - val_accuracy: 0.9567
Epoch 59/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.2305 - accuracy: 0.9462 - val_loss: 20.7204 - val_accuracy: 0.9478
Epoch 60/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.4538 - accuracy: 0.9424 - val_loss: 18.6684 - val_accuracy: 0.9555
Epoch 61/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.4972 - accuracy: 0.9425 - val_loss: 21.0111 - val_accuracy: 0.9503
Epoch 62/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.3502 - accuracy: 0.9445 - val_loss: 17.6538 - val_accuracy: 0.9550
Epoch 63/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.2362 - accuracy: 0.9466 - val_loss: 19.2515 - val_accuracy: 0.9517
Epoch 64/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.3120 - accuracy: 0.9456 - val_loss: 19.0320 - val_accuracy: 0.9519
Epoch 65/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.1807 - accuracy: 0.9471 - val_loss: 18.6290 - val_accuracy: 0.9524
Epoch 66/100
1200/1200 [==============================] - 11s 9ms/step - loss: 4.1032 - accuracy: 0.9473 - val_loss: 23.1570 - val_accuracy: 0.9428
Epoch 67/100
1200/1200 [==============================] - 11s 9ms/step - loss: 4.1482 - accuracy: 0.9466 - val_loss: 20.6476 - val_accuracy: 0.9485
Epoch 68/100
1200/1200 [==============================] - 11s 10ms/step - loss: 4.1911 - accuracy: 0.9464 - val_loss: 19.4447 - val_accuracy: 0.9525
Epoch 69/100
1200/1200 [==============================] - 11s 10ms/step - loss: 4.1647 - accuracy: 0.9470 - val_loss: 20.1413 - val_accuracy: 0.9500
Epoch 70/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.0435 - accuracy: 0.9480 - val_loss: 18.3175 - val_accuracy: 0.9559
Epoch 71/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.1583 - accuracy: 0.9470 - val_loss: 19.1983 - val_accuracy: 0.9521
Epoch 72/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.0703 - accuracy: 0.9484 - val_loss: 19.3595 - val_accuracy: 0.9524
Epoch 73/100
1200/1200 [==============================] - 11s 10ms/step - loss: 3.9769 - accuracy: 0.9488 - val_loss: 17.1363 - val_accuracy: 0.9572
Epoch 74/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.2731 - accuracy: 0.9451 - val_loss: 21.1529 - val_accuracy: 0.9465
Epoch 75/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.0835 - accuracy: 0.9486 - val_loss: 17.4637 - val_accuracy: 0.9568
Epoch 76/100
1200/1200 [==============================] - 12s 10ms/step - loss: 3.9035 - accuracy: 0.9510 - val_loss: 19.2089 - val_accuracy: 0.9511
Epoch 77/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.0598 - accuracy: 0.9480 - val_loss: 23.8218 - val_accuracy: 0.9404
Epoch 78/100
1200/1200 [==============================] - 11s 10ms/step - loss: 4.0073 - accuracy: 0.9491 - val_loss: 17.5540 - val_accuracy: 0.9558
Epoch 79/100
1200/1200 [==============================] - 11s 10ms/step - loss: 3.9384 - accuracy: 0.9495 - val_loss: 18.6351 - val_accuracy: 0.9531
Epoch 80/100
1200/1200 [==============================] - 11s 9ms/step - loss: 4.0619 - accuracy: 0.9479 - val_loss: 17.6715 - val_accuracy: 0.9569
Epoch 81/100
1200/1200 [==============================] - 11s 10ms/step - loss: 4.1203 - accuracy: 0.9477 - val_loss: 21.1572 - val_accuracy: 0.9472
Epoch 82/100
1200/1200 [==============================] - 12s 10ms/step - loss: 4.0393 - accuracy: 0.9480 - val_loss: 19.5484 - val_accuracy: 0.9510
Epoch 83/100
1200/1200 [==============================] - 11s 10ms/step - loss: 4.1189 - accuracy: 0.9482 - val_loss: 18.1107 - val_accuracy: 0.9559
Epoch 84/100
1200/1200 [==============================] - 11s 10ms/step - loss: 3.9135 - accuracy: 0.9495 - val_loss: 18.5417 - val_accuracy: 0.9528
Epoch 85/100
1200/1200 [==============================] - 11s 10ms/step - loss: 3.9572 - accuracy: 0.9487 - val_loss: 17.1412 - val_accuracy: 0.9587
Epoch 86/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.0315 - accuracy: 0.9493 - val_loss: 22.0326 - val_accuracy: 0.9454
Epoch 87/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.0152 - accuracy: 0.9495 - val_loss: 17.8505 - val_accuracy: 0.9543
Epoch 88/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.8692 - accuracy: 0.9511 - val_loss: 25.4177 - val_accuracy: 0.9363
Epoch 89/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.9717 - accuracy: 0.9489 - val_loss: 21.3272 - val_accuracy: 0.9480
Epoch 90/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.9500 - accuracy: 0.9505 - val_loss: 17.0123 - val_accuracy: 0.9566
Epoch 91/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.0087 - accuracy: 0.9490 - val_loss: 17.8606 - val_accuracy: 0.9565
Epoch 92/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.8430 - accuracy: 0.9511 - val_loss: 19.4851 - val_accuracy: 0.9519
Epoch 93/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.9371 - accuracy: 0.9506 - val_loss: 18.7248 - val_accuracy: 0.9525
Epoch 94/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.8947 - accuracy: 0.9499 - val_loss: 20.5617 - val_accuracy: 0.9480
Epoch 95/100
1200/1200 [==============================] - 13s 11ms/step - loss: 4.0566 - accuracy: 0.9486 - val_loss: 18.2864 - val_accuracy: 0.9528
Epoch 96/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.9023 - accuracy: 0.9501 - val_loss: 16.9599 - val_accuracy: 0.9581
Epoch 97/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.9252 - accuracy: 0.9501 - val_loss: 17.1938 - val_accuracy: 0.9573
Epoch 98/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.9653 - accuracy: 0.9500 - val_loss: 21.3669 - val_accuracy: 0.9464
Epoch 99/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.9036 - accuracy: 0.9505 - val_loss: 17.6310 - val_accuracy: 0.9574
Epoch 100/100
1200/1200 [==============================] - 13s 11ms/step - loss: 3.9843 - accuracy: 0.9492 - val_loss: 22.0454 - val_accuracy: 0.9453
313/313 [==============================] - 1s 4ms/step - loss: 2.1427 - accuracy: 0.9587
1875/1875 [==============================] - 8s 4ms/step - loss: 2.2218 - accuracy: 0.9558
