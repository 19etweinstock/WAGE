2021-11-28 2046
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 90
batchSize = 50

lr_schedule = [0, 1., 70, 0.7]

[[0, 70], [1.0, 1.0, 0.7]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
Epoch 1/90
1200/1200 [==============================] - 15s 11ms/step - loss: 0.0716 - accuracy: 0.4489
Epoch 2/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0422 - accuracy: 0.7241
Epoch 3/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0300 - accuracy: 0.8106
Epoch 4/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0242 - accuracy: 0.8480
Epoch 5/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0206 - accuracy: 0.8731
Epoch 6/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0184 - accuracy: 0.8848
Epoch 7/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0168 - accuracy: 0.8946
Epoch 8/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0157 - accuracy: 0.9020
Epoch 9/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0151 - accuracy: 0.9047
Epoch 10/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0143 - accuracy: 0.9098
Epoch 11/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0132 - accuracy: 0.9167
Epoch 12/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0124 - accuracy: 0.9213
Epoch 13/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0122 - accuracy: 0.9235
Epoch 14/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0120 - accuracy: 0.9241
Epoch 15/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0121 - accuracy: 0.9229
Epoch 16/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0118 - accuracy: 0.9247
Epoch 17/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0113 - accuracy: 0.9279
Epoch 18/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0114 - accuracy: 0.9275
Epoch 19/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0110 - accuracy: 0.9299
Epoch 20/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0109 - accuracy: 0.9309
Epoch 21/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0105 - accuracy: 0.9336
Epoch 22/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0105 - accuracy: 0.9328
Epoch 23/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0105 - accuracy: 0.9324
Epoch 24/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0104 - accuracy: 0.9335
Epoch 25/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0103 - accuracy: 0.9343
Epoch 26/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0101 - accuracy: 0.9358
Epoch 27/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0097 - accuracy: 0.9382
Epoch 28/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0099 - accuracy: 0.9363
Epoch 29/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0099 - accuracy: 0.9371
Epoch 30/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0100 - accuracy: 0.9360
Epoch 31/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0099 - accuracy: 0.9373
Epoch 32/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0093 - accuracy: 0.9412
Epoch 33/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0095 - accuracy: 0.9404
Epoch 34/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0095 - accuracy: 0.9395
Epoch 35/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0093 - accuracy: 0.9405
Epoch 36/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0093 - accuracy: 0.9411
Epoch 37/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0093 - accuracy: 0.9406
Epoch 38/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0097 - accuracy: 0.9380
Epoch 39/90
1200/1200 [==============================] - 14s 12ms/step - loss: 0.0093 - accuracy: 0.9407
Epoch 40/90
1200/1200 [==============================] - 14s 11ms/step - loss: 0.0093 - accuracy: 0.9415
Epoch 41/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0091 - accuracy: 0.9422
Epoch 42/90
1200/1200 [==============================] - 14s 11ms/step - loss: 0.0088 - accuracy: 0.9434
Epoch 43/90
1200/1200 [==============================] - 14s 12ms/step - loss: 0.0091 - accuracy: 0.9424
Epoch 44/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0087 - accuracy: 0.9445
Epoch 45/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0090 - accuracy: 0.9426
Epoch 46/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0089 - accuracy: 0.9430
Epoch 47/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0088 - accuracy: 0.9440
Epoch 48/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0086 - accuracy: 0.9451
Epoch 49/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0085 - accuracy: 0.9453
Epoch 50/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0083 - accuracy: 0.9467
Epoch 51/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0088 - accuracy: 0.9433
Epoch 52/90
 369/1200 [========>.....................] - ETA: 8s - loss: nan - accuracy: 0.9433   Batch 368: Invalid loss, terminating training
1200/1200 [==============================] - 4s 3ms/step - loss: nan - accuracy: 0.9433
313/313 [==============================] - 2s 5ms/step - loss: nan - accuracy: 0.0980
1875/1875 [==============================] - 10s 5ms/step - loss: nan - accuracy: 0.0987
