2022-01-22 1550
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

loops = 2
Epoch = 50
batchSize = 50

lr_schedule = [0, 1., 20, 0.5, 35, 0.25]

# loadModel = None
loadModel = '2022-01-21 1844(MNIST 1288 8 [0, 1.0, 20, 0.5, 35, 0.25] 50 50)'

[[0, 20, 35], [1.0, 1.0, 0.5, 0.25]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
conv/qconv2d [5, 5, 1, 6] Scale: 4
conv/qconv2d_1 [5, 5, 6, 8] Scale: 8
fc/qfc [128, 120] Scale: 8
fc/qfc_1 [120, 84] Scale: 8
fc/qfc_2 [84, 10] Scale: 8
CONV: 1350 FC: 26280 TOTAL: 27630
Epoch 1/50
1200/1200 [==============================] - 59s 41ms/step - loss: 3.2542 - accuracy: 0.9579 - val_loss: 15.5596 - val_accuracy: 0.9612
Epoch 2/50
1200/1200 [==============================] - 41s 34ms/step - loss: 3.2765 - accuracy: 0.9589 - val_loss: 16.4994 - val_accuracy: 0.9573
Epoch 3/50
1200/1200 [==============================] - 41s 34ms/step - loss: 3.2034 - accuracy: 0.9591 - val_loss: 16.2678 - val_accuracy: 0.9593
Epoch 4/50
1200/1200 [==============================] - 41s 35ms/step - loss: 3.1654 - accuracy: 0.9602 - val_loss: 15.5543 - val_accuracy: 0.9598
Epoch 5/50
1200/1200 [==============================] - 40s 33ms/step - loss: 3.1520 - accuracy: 0.9604 - val_loss: 14.6177 - val_accuracy: 0.9637
Epoch 6/50
1200/1200 [==============================] - 37s 31ms/step - loss: 3.1271 - accuracy: 0.9607 - val_loss: 13.6759 - val_accuracy: 0.9679
Epoch 7/50
1200/1200 [==============================] - 42s 35ms/step - loss: 3.2707 - accuracy: 0.9588 - val_loss: 15.1456 - val_accuracy: 0.9612
Epoch 8/50
1200/1200 [==============================] - 39s 33ms/step - loss: 3.2919 - accuracy: 0.9582 - val_loss: 19.2651 - val_accuracy: 0.9528
Epoch 9/50
1200/1200 [==============================] - 40s 33ms/step - loss: 3.3080 - accuracy: 0.9580 - val_loss: 15.6746 - val_accuracy: 0.9620
Epoch 10/50
1200/1200 [==============================] - 35s 30ms/step - loss: 3.2561 - accuracy: 0.9583 - val_loss: 14.5790 - val_accuracy: 0.9634
Epoch 11/50
1200/1200 [==============================] - 34s 28ms/step - loss: 3.1753 - accuracy: 0.9591 - val_loss: 14.2022 - val_accuracy: 0.9657
Epoch 12/50
1200/1200 [==============================] - 36s 30ms/step - loss: 3.2992 - accuracy: 0.9582 - val_loss: 15.7303 - val_accuracy: 0.9600
Epoch 13/50
1200/1200 [==============================] - 37s 31ms/step - loss: 3.2066 - accuracy: 0.9590 - val_loss: 14.3141 - val_accuracy: 0.9647
Epoch 14/50
1200/1200 [==============================] - 39s 32ms/step - loss: 3.1331 - accuracy: 0.9603 - val_loss: 20.0312 - val_accuracy: 0.9501
Epoch 15/50
1200/1200 [==============================] - 45s 38ms/step - loss: 3.4173 - accuracy: 0.9565 - val_loss: 18.1771 - val_accuracy: 0.9536
Epoch 16/50
1200/1200 [==============================] - 43s 36ms/step - loss: 3.2164 - accuracy: 0.9588 - val_loss: 15.9155 - val_accuracy: 0.9605
Epoch 17/50
1200/1200 [==============================] - 39s 33ms/step - loss: 3.1542 - accuracy: 0.9601 - val_loss: 16.9432 - val_accuracy: 0.9562
Epoch 18/50
1200/1200 [==============================] - 36s 30ms/step - loss: 3.2498 - accuracy: 0.9590 - val_loss: 14.8105 - val_accuracy: 0.9618
Epoch 19/50
1200/1200 [==============================] - 38s 32ms/step - loss: 3.3065 - accuracy: 0.9577 - val_loss: 16.5929 - val_accuracy: 0.9588
Epoch 20/50
1200/1200 [==============================] - 34s 28ms/step - loss: 3.1798 - accuracy: 0.9593 - val_loss: 17.4153 - val_accuracy: 0.9566
Epoch 21/50
1200/1200 [==============================] - 33s 28ms/step - loss: 3.0588 - accuracy: 0.9612 - val_loss: 15.9879 - val_accuracy: 0.9590
Epoch 22/50
1200/1200 [==============================] - 33s 28ms/step - loss: 3.3455 - accuracy: 0.9578 - val_loss: 15.2081 - val_accuracy: 0.9617
Epoch 23/50
1200/1200 [==============================] - 33s 28ms/step - loss: 3.1677 - accuracy: 0.9592 - val_loss: 13.7887 - val_accuracy: 0.9659
Epoch 24/50
1200/1200 [==============================] - 33s 28ms/step - loss: 3.2162 - accuracy: 0.9592 - val_loss: 14.1362 - val_accuracy: 0.9640
Epoch 25/50
1200/1200 [==============================] - 39s 32ms/step - loss: 3.0422 - accuracy: 0.9618 - val_loss: 17.6948 - val_accuracy: 0.9553
Epoch 26/50
1200/1200 [==============================] - 36s 30ms/step - loss: 3.1822 - accuracy: 0.9600 - val_loss: 15.6422 - val_accuracy: 0.9615
Epoch 27/50
1200/1200 [==============================] - 36s 30ms/step - loss: 3.3499 - accuracy: 0.9571 - val_loss: 15.4034 - val_accuracy: 0.9623
Epoch 28/50
1200/1200 [==============================] - 36s 30ms/step - loss: 3.2955 - accuracy: 0.9578 - val_loss: 15.5022 - val_accuracy: 0.9613
Epoch 29/50
1200/1200 [==============================] - 29s 24ms/step - loss: 3.0774 - accuracy: 0.9618 - val_loss: 15.1021 - val_accuracy: 0.9616
Epoch 30/50
1200/1200 [==============================] - 14s 11ms/step - loss: 3.1034 - accuracy: 0.9608 - val_loss: 17.2360 - val_accuracy: 0.9568
Epoch 31/50
1200/1200 [==============================] - 14s 12ms/step - loss: 3.2222 - accuracy: 0.9589 - val_loss: 18.2987 - val_accuracy: 0.9543
Epoch 32/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1584 - accuracy: 0.9604 - val_loss: 14.4931 - val_accuracy: 0.9645
Epoch 33/50
1200/1200 [==============================] - 14s 11ms/step - loss: 3.2097 - accuracy: 0.9593 - val_loss: 14.5487 - val_accuracy: 0.9641
Epoch 34/50
1200/1200 [==============================] - 14s 11ms/step - loss: 3.2045 - accuracy: 0.9591 - val_loss: 16.0079 - val_accuracy: 0.9600
Epoch 35/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.0943 - accuracy: 0.9610 - val_loss: 16.2348 - val_accuracy: 0.9599
Epoch 36/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1856 - accuracy: 0.9596 - val_loss: 15.2202 - val_accuracy: 0.9614
Epoch 37/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1217 - accuracy: 0.9603 - val_loss: 15.2043 - val_accuracy: 0.9622
Epoch 38/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2494 - accuracy: 0.9589 - val_loss: 15.2510 - val_accuracy: 0.9613
Epoch 39/50
1200/1200 [==============================] - 14s 11ms/step - loss: 3.2280 - accuracy: 0.9586 - val_loss: 16.5878 - val_accuracy: 0.9594
Epoch 40/50
1200/1200 [==============================] - 14s 12ms/step - loss: 3.1120 - accuracy: 0.9603 - val_loss: 13.4520 - val_accuracy: 0.9667
Epoch 41/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.0725 - accuracy: 0.9608 - val_loss: 16.7834 - val_accuracy: 0.9572
Epoch 42/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1826 - accuracy: 0.9592 - val_loss: 20.6561 - val_accuracy: 0.9461
Epoch 43/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1469 - accuracy: 0.9596 - val_loss: 14.0926 - val_accuracy: 0.9650
Epoch 44/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1820 - accuracy: 0.9596 - val_loss: 14.8659 - val_accuracy: 0.9629
Epoch 45/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1240 - accuracy: 0.9604 - val_loss: 15.9710 - val_accuracy: 0.9612
Epoch 46/50
1200/1200 [==============================] - 14s 12ms/step - loss: 3.0640 - accuracy: 0.9616 - val_loss: 14.5832 - val_accuracy: 0.9630
Epoch 47/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2308 - accuracy: 0.9589 - val_loss: 16.4436 - val_accuracy: 0.9580
Epoch 48/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1246 - accuracy: 0.9599 - val_loss: 16.4447 - val_accuracy: 0.9589
Epoch 49/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1905 - accuracy: 0.9595 - val_loss: 16.9588 - val_accuracy: 0.9569
Epoch 50/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1393 - accuracy: 0.9599 - val_loss: 19.6298 - val_accuracy: 0.9509
40/40 [==============================] - 0s 4ms/step - loss: 13.6759 - accuracy: 0.9679
235/235 [==============================] - 1s 4ms/step - loss: 14.5632 - accuracy: 0.9649
Epoch 1/50
1200/1200 [==============================] - 14s 11ms/step - loss: 3.1253 - accuracy: 0.9609 - val_loss: 15.8881 - val_accuracy: 0.9604
Epoch 2/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.0805 - accuracy: 0.9614 - val_loss: 14.9325 - val_accuracy: 0.9614
Epoch 3/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.0775 - accuracy: 0.9611 - val_loss: 15.8151 - val_accuracy: 0.9615
Epoch 4/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.0414 - accuracy: 0.9613 - val_loss: 15.3410 - val_accuracy: 0.9606
Epoch 5/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1618 - accuracy: 0.9598 - val_loss: 15.3385 - val_accuracy: 0.9616
Epoch 6/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2165 - accuracy: 0.9588 - val_loss: 18.2183 - val_accuracy: 0.9548
Epoch 7/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2955 - accuracy: 0.9578 - val_loss: 15.2241 - val_accuracy: 0.9629
Epoch 8/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2398 - accuracy: 0.9584 - val_loss: 15.6171 - val_accuracy: 0.9613
Epoch 9/50
1200/1200 [==============================] - 14s 12ms/step - loss: 3.2478 - accuracy: 0.9591 - val_loss: 13.7804 - val_accuracy: 0.9664
Epoch 10/50
1200/1200 [==============================] - 14s 12ms/step - loss: 3.3022 - accuracy: 0.9568 - val_loss: 15.0247 - val_accuracy: 0.9632
Epoch 11/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2663 - accuracy: 0.9588 - val_loss: 14.3398 - val_accuracy: 0.9641
Epoch 12/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3992 - accuracy: 0.9569 - val_loss: 15.5766 - val_accuracy: 0.9594
Epoch 13/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.4329 - accuracy: 0.9565 - val_loss: 15.1870 - val_accuracy: 0.9619
Epoch 14/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2368 - accuracy: 0.9592 - val_loss: 15.9206 - val_accuracy: 0.9595
Epoch 15/50
1200/1200 [==============================] - 14s 11ms/step - loss: 3.1208 - accuracy: 0.9598 - val_loss: 17.2363 - val_accuracy: 0.9574
Epoch 16/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1974 - accuracy: 0.9589 - val_loss: 15.6897 - val_accuracy: 0.9611
Epoch 17/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1717 - accuracy: 0.9597 - val_loss: 18.1202 - val_accuracy: 0.9554
Epoch 18/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1738 - accuracy: 0.9599 - val_loss: 15.3917 - val_accuracy: 0.9625
Epoch 19/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.4407 - accuracy: 0.9560 - val_loss: 15.3005 - val_accuracy: 0.9622
Epoch 20/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2153 - accuracy: 0.9582 - val_loss: 22.5863 - val_accuracy: 0.9469
Epoch 21/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1448 - accuracy: 0.9601 - val_loss: 13.3934 - val_accuracy: 0.9664
Epoch 22/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1086 - accuracy: 0.9602 - val_loss: 14.4914 - val_accuracy: 0.9642
Epoch 23/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.0559 - accuracy: 0.9609 - val_loss: 17.3857 - val_accuracy: 0.9552
Epoch 24/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1929 - accuracy: 0.9589 - val_loss: 19.0699 - val_accuracy: 0.9533
Epoch 25/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1019 - accuracy: 0.9605 - val_loss: 15.0204 - val_accuracy: 0.9621
Epoch 26/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1454 - accuracy: 0.9602 - val_loss: 15.0709 - val_accuracy: 0.9617
Epoch 27/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2382 - accuracy: 0.9587 - val_loss: 13.7277 - val_accuracy: 0.9656
Epoch 28/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2727 - accuracy: 0.9581 - val_loss: 13.7754 - val_accuracy: 0.9655
Epoch 29/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1104 - accuracy: 0.9603 - val_loss: 14.3597 - val_accuracy: 0.9654
Epoch 30/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1250 - accuracy: 0.9608 - val_loss: 13.6925 - val_accuracy: 0.9653
Epoch 31/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2514 - accuracy: 0.9583 - val_loss: 15.5209 - val_accuracy: 0.9621
Epoch 32/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1692 - accuracy: 0.9599 - val_loss: 17.1919 - val_accuracy: 0.9573
Epoch 33/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1928 - accuracy: 0.9588 - val_loss: 15.4641 - val_accuracy: 0.9617
Epoch 34/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1351 - accuracy: 0.9604 - val_loss: 14.4695 - val_accuracy: 0.9631
Epoch 35/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1949 - accuracy: 0.9592 - val_loss: 14.2799 - val_accuracy: 0.9635
Epoch 36/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2578 - accuracy: 0.9584 - val_loss: 14.6804 - val_accuracy: 0.9640
Epoch 37/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1944 - accuracy: 0.9597 - val_loss: 15.5910 - val_accuracy: 0.9602
Epoch 38/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1960 - accuracy: 0.9595 - val_loss: 15.7003 - val_accuracy: 0.9592
Epoch 39/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2326 - accuracy: 0.9582 - val_loss: 14.8067 - val_accuracy: 0.9641
Epoch 40/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2290 - accuracy: 0.9593 - val_loss: 14.9036 - val_accuracy: 0.9617
Epoch 41/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1869 - accuracy: 0.9590 - val_loss: 14.0384 - val_accuracy: 0.9658
Epoch 42/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1738 - accuracy: 0.9596 - val_loss: 14.4581 - val_accuracy: 0.9635
Epoch 43/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2231 - accuracy: 0.9593 - val_loss: 20.1253 - val_accuracy: 0.9488
Epoch 44/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1664 - accuracy: 0.9598 - val_loss: 16.1907 - val_accuracy: 0.9606
Epoch 45/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2172 - accuracy: 0.9594 - val_loss: 16.8772 - val_accuracy: 0.9568
Epoch 46/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2349 - accuracy: 0.9585 - val_loss: 17.6654 - val_accuracy: 0.9554
Epoch 47/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2787 - accuracy: 0.9578 - val_loss: 13.4516 - val_accuracy: 0.9661
Epoch 48/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.0997 - accuracy: 0.9606 - val_loss: 15.6831 - val_accuracy: 0.9607
Epoch 49/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1871 - accuracy: 0.9593 - val_loss: 15.4768 - val_accuracy: 0.9620
Epoch 50/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2926 - accuracy: 0.9583 - val_loss: 15.7325 - val_accuracy: 0.9603
40/40 [==============================] - 0s 5ms/step - loss: 13.6759 - accuracy: 0.9679
235/235 [==============================] - 1s 5ms/step - loss: 14.5632 - accuracy: 0.9649
