2022-01-22 1652
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

loops = 2
Epoch = 50
batchSize = 50

lr_schedule = [0, 1., 20, 0.5, 35, 0.25]

# loadModel = None
loadModel = '2022-01-21 1844(MNIST 1288 8 [0, 1.0, 20, 0.5, 35, 0.25] 50 50)'

[[0, 20, 35], [1.0, 1.0, 0.5, 0.25]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
conv/qconv2d [5, 5, 1, 6] Scale: 4
conv/qconv2d_1 [5, 5, 6, 8] Scale: 8
fc/qfc [128, 120] Scale: 8
fc/qfc_1 [120, 84] Scale: 8
fc/qfc_2 [84, 10] Scale: 8
CONV: 1350 FC: 26280 TOTAL: 27630
Epoch 1/50
1200/1200 [==============================] - 15s 11ms/step - loss: 3.2902 - accuracy: 0.9584 - val_loss: 14.5995 - val_accuracy: 0.9649
Epoch 2/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3165 - accuracy: 0.9578 - val_loss: 15.4020 - val_accuracy: 0.9613
Epoch 3/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2422 - accuracy: 0.9586 - val_loss: 16.5724 - val_accuracy: 0.9582
Epoch 4/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1842 - accuracy: 0.9594 - val_loss: 15.4734 - val_accuracy: 0.9612
Epoch 5/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1616 - accuracy: 0.9601 - val_loss: 15.9543 - val_accuracy: 0.9592
Epoch 6/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2116 - accuracy: 0.9588 - val_loss: 14.4640 - val_accuracy: 0.9627
Epoch 7/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1539 - accuracy: 0.9601 - val_loss: 15.1876 - val_accuracy: 0.9611
Epoch 8/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2172 - accuracy: 0.9593 - val_loss: 18.3477 - val_accuracy: 0.9532
Epoch 9/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2248 - accuracy: 0.9593 - val_loss: 15.8273 - val_accuracy: 0.9595
Epoch 10/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2879 - accuracy: 0.9588 - val_loss: 12.9361 - val_accuracy: 0.9681
Epoch 11/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1454 - accuracy: 0.9601 - val_loss: 14.0810 - val_accuracy: 0.9657
Epoch 12/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2114 - accuracy: 0.9598 - val_loss: 18.4193 - val_accuracy: 0.9543
Epoch 13/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.3171 - accuracy: 0.9578 - val_loss: 14.9813 - val_accuracy: 0.9616
Epoch 14/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1534 - accuracy: 0.9595 - val_loss: 17.7951 - val_accuracy: 0.9558
Epoch 15/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2274 - accuracy: 0.9591 - val_loss: 14.5469 - val_accuracy: 0.9628
Epoch 16/50
1200/1200 [==============================] - 13s 10ms/step - loss: 3.2971 - accuracy: 0.9583 - val_loss: 14.8585 - val_accuracy: 0.9621
Epoch 17/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2124 - accuracy: 0.9591 - val_loss: 14.9960 - val_accuracy: 0.9617
Epoch 18/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2404 - accuracy: 0.9588 - val_loss: 14.5240 - val_accuracy: 0.9629
Epoch 19/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1489 - accuracy: 0.9599 - val_loss: 16.2444 - val_accuracy: 0.9591
Epoch 20/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1971 - accuracy: 0.9597 - val_loss: 16.5799 - val_accuracy: 0.9571
Epoch 21/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2636 - accuracy: 0.9593 - val_loss: 14.1062 - val_accuracy: 0.9648
Epoch 22/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2381 - accuracy: 0.9587 - val_loss: 14.0018 - val_accuracy: 0.9643
Epoch 23/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1638 - accuracy: 0.9601 - val_loss: 17.9034 - val_accuracy: 0.9556
Epoch 24/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3137 - accuracy: 0.9581 - val_loss: 14.8098 - val_accuracy: 0.9635
Epoch 25/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3085 - accuracy: 0.9582 - val_loss: 15.3489 - val_accuracy: 0.9614
Epoch 26/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1576 - accuracy: 0.9597 - val_loss: 14.3314 - val_accuracy: 0.9663
Epoch 27/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1965 - accuracy: 0.9589 - val_loss: 16.6951 - val_accuracy: 0.9588
Epoch 28/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2576 - accuracy: 0.9587 - val_loss: 13.7674 - val_accuracy: 0.9660
Epoch 29/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1707 - accuracy: 0.9597 - val_loss: 14.1344 - val_accuracy: 0.9661
Epoch 30/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2159 - accuracy: 0.9590 - val_loss: 14.1913 - val_accuracy: 0.9638
Epoch 31/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2333 - accuracy: 0.9589 - val_loss: 16.6604 - val_accuracy: 0.9595
Epoch 32/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1774 - accuracy: 0.9600 - val_loss: 16.7984 - val_accuracy: 0.9595
Epoch 33/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1713 - accuracy: 0.9598 - val_loss: 15.5527 - val_accuracy: 0.9606
Epoch 34/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2699 - accuracy: 0.9592 - val_loss: 15.5217 - val_accuracy: 0.9608
Epoch 35/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2584 - accuracy: 0.9590 - val_loss: 19.7636 - val_accuracy: 0.9521
Epoch 36/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.1798 - accuracy: 0.9597 - val_loss: 15.8589 - val_accuracy: 0.9590
Epoch 37/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2466 - accuracy: 0.9586 - val_loss: 13.9367 - val_accuracy: 0.9653
Epoch 38/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2136 - accuracy: 0.9592 - val_loss: 14.4007 - val_accuracy: 0.9632
Epoch 39/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2666 - accuracy: 0.9586 - val_loss: 18.8816 - val_accuracy: 0.9536
Epoch 40/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2313 - accuracy: 0.9594 - val_loss: 15.3985 - val_accuracy: 0.9634
Epoch 41/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.0776 - accuracy: 0.9610 - val_loss: 15.4274 - val_accuracy: 0.9600
Epoch 42/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1472 - accuracy: 0.9603 - val_loss: 18.1924 - val_accuracy: 0.9552
Epoch 43/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2195 - accuracy: 0.9595 - val_loss: 13.8444 - val_accuracy: 0.9652
Epoch 44/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2531 - accuracy: 0.9586 - val_loss: 15.8410 - val_accuracy: 0.9608
Epoch 45/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2501 - accuracy: 0.9586 - val_loss: 17.8365 - val_accuracy: 0.9566
Epoch 46/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2821 - accuracy: 0.9582 - val_loss: 14.8320 - val_accuracy: 0.9632
Epoch 47/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3054 - accuracy: 0.9577 - val_loss: 14.5489 - val_accuracy: 0.9653
Epoch 48/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1372 - accuracy: 0.9605 - val_loss: 14.4827 - val_accuracy: 0.9630
Epoch 49/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1928 - accuracy: 0.9595 - val_loss: 15.3584 - val_accuracy: 0.9607
Epoch 50/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1107 - accuracy: 0.9606 - val_loss: 15.0802 - val_accuracy: 0.9618
40/40 [==============================] - 0s 4ms/step - loss: 12.9361 - accuracy: 0.9681
235/235 [==============================] - 1s 4ms/step - loss: 14.7589 - accuracy: 0.9628
Epoch 1/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.3465 - accuracy: 0.9570 - val_loss: 15.3432 - val_accuracy: 0.9605
Epoch 2/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2587 - accuracy: 0.9585 - val_loss: 16.6261 - val_accuracy: 0.9589
Epoch 3/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3052 - accuracy: 0.9577 - val_loss: 16.5982 - val_accuracy: 0.9587
Epoch 4/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2408 - accuracy: 0.9587 - val_loss: 15.4038 - val_accuracy: 0.9618
Epoch 5/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.4115 - accuracy: 0.9572 - val_loss: 16.0822 - val_accuracy: 0.9599
Epoch 6/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2878 - accuracy: 0.9584 - val_loss: 17.0095 - val_accuracy: 0.9560
Epoch 7/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3594 - accuracy: 0.9574 - val_loss: 19.7066 - val_accuracy: 0.9479
Epoch 8/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3907 - accuracy: 0.9566 - val_loss: 17.4250 - val_accuracy: 0.9551
Epoch 9/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2979 - accuracy: 0.9582 - val_loss: 15.5419 - val_accuracy: 0.9626
Epoch 10/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2548 - accuracy: 0.9587 - val_loss: 15.4722 - val_accuracy: 0.9607
Epoch 11/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1721 - accuracy: 0.9596 - val_loss: 19.8871 - val_accuracy: 0.9497
Epoch 12/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1328 - accuracy: 0.9598 - val_loss: 15.4646 - val_accuracy: 0.9615
Epoch 13/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2937 - accuracy: 0.9583 - val_loss: 17.3323 - val_accuracy: 0.9547
Epoch 14/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2643 - accuracy: 0.9585 - val_loss: 16.0949 - val_accuracy: 0.9606
Epoch 15/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2691 - accuracy: 0.9584 - val_loss: 16.2853 - val_accuracy: 0.9604
Epoch 16/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3392 - accuracy: 0.9577 - val_loss: 18.2898 - val_accuracy: 0.9552
Epoch 17/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2312 - accuracy: 0.9594 - val_loss: 14.0618 - val_accuracy: 0.9644
Epoch 18/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2076 - accuracy: 0.9592 - val_loss: 14.5705 - val_accuracy: 0.9630
Epoch 19/50
1200/1200 [==============================] - 14s 11ms/step - loss: 3.2326 - accuracy: 0.9591 - val_loss: 14.3252 - val_accuracy: 0.9640
Epoch 20/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2327 - accuracy: 0.9589 - val_loss: 18.0441 - val_accuracy: 0.9559
Epoch 21/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2807 - accuracy: 0.9584 - val_loss: 18.0473 - val_accuracy: 0.9569
Epoch 22/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3464 - accuracy: 0.9573 - val_loss: 16.9263 - val_accuracy: 0.9589
Epoch 23/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2450 - accuracy: 0.9587 - val_loss: 17.2473 - val_accuracy: 0.9557
Epoch 24/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2465 - accuracy: 0.9586 - val_loss: 16.4190 - val_accuracy: 0.9602
Epoch 25/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2849 - accuracy: 0.9587 - val_loss: 15.8080 - val_accuracy: 0.9607
Epoch 26/50
1200/1200 [==============================] - 14s 11ms/step - loss: 3.2756 - accuracy: 0.9586 - val_loss: 15.1921 - val_accuracy: 0.9628
Epoch 27/50
1200/1200 [==============================] - 13s 11ms/step - loss: 3.2111 - accuracy: 0.9599 - val_loss: 14.2837 - val_accuracy: 0.9660
Epoch 28/50
1200/1200 [==============================] - 14s 11ms/step - loss: 3.1721 - accuracy: 0.9595 - val_loss: 15.3521 - val_accuracy: 0.9615
Epoch 29/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1505 - accuracy: 0.9601 - val_loss: 17.1908 - val_accuracy: 0.9562
Epoch 30/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2713 - accuracy: 0.9583 - val_loss: 14.4692 - val_accuracy: 0.9620
Epoch 31/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2032 - accuracy: 0.9594 - val_loss: 16.4977 - val_accuracy: 0.9598
Epoch 32/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1880 - accuracy: 0.9598 - val_loss: 15.5142 - val_accuracy: 0.9605
Epoch 33/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2247 - accuracy: 0.9589 - val_loss: 17.3635 - val_accuracy: 0.9562
Epoch 34/50
1200/1200 [==============================] - 13s 10ms/step - loss: 3.1969 - accuracy: 0.9590 - val_loss: 15.3729 - val_accuracy: 0.9605
Epoch 35/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1766 - accuracy: 0.9596 - val_loss: 16.2025 - val_accuracy: 0.9594
Epoch 36/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2662 - accuracy: 0.9587 - val_loss: 13.8358 - val_accuracy: 0.9652
Epoch 37/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2001 - accuracy: 0.9598 - val_loss: 17.5723 - val_accuracy: 0.9577
Epoch 38/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1696 - accuracy: 0.9596 - val_loss: 15.8688 - val_accuracy: 0.9595
Epoch 39/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1536 - accuracy: 0.9597 - val_loss: 17.6300 - val_accuracy: 0.9570
Epoch 40/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2232 - accuracy: 0.9594 - val_loss: 15.2626 - val_accuracy: 0.9608
Epoch 41/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2942 - accuracy: 0.9585 - val_loss: 17.5751 - val_accuracy: 0.9557
Epoch 42/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.3037 - accuracy: 0.9578 - val_loss: 15.5971 - val_accuracy: 0.9618
Epoch 43/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2961 - accuracy: 0.9584 - val_loss: 15.8215 - val_accuracy: 0.9604
Epoch 44/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2290 - accuracy: 0.9591 - val_loss: 15.6310 - val_accuracy: 0.9611
Epoch 45/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2986 - accuracy: 0.9580 - val_loss: 18.6766 - val_accuracy: 0.9547
Epoch 46/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2580 - accuracy: 0.9588 - val_loss: 16.0521 - val_accuracy: 0.9598
Epoch 47/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1792 - accuracy: 0.9599 - val_loss: 19.9245 - val_accuracy: 0.9512
Epoch 48/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.1180 - accuracy: 0.9607 - val_loss: 14.8443 - val_accuracy: 0.9639
Epoch 49/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2198 - accuracy: 0.9590 - val_loss: 20.5635 - val_accuracy: 0.9468
Epoch 50/50
1200/1200 [==============================] - 12s 10ms/step - loss: 3.2296 - accuracy: 0.9585 - val_loss: 16.5791 - val_accuracy: 0.9602
40/40 [==============================] - 0s 4ms/step - loss: 12.9361 - accuracy: 0.9681
235/235 [==============================] - 1s 4ms/step - loss: 14.7589 - accuracy: 0.9628
