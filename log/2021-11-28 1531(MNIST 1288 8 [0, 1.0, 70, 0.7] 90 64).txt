2021-11-28 1531
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 90
batchSize = 64

lr_schedule = [0, 1., 70, 0.7]

[[0, 70], [1.0, 1.0, 0.7]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
Epoch 1/90
938/938 [==============================] - 11s 10ms/step - loss: 0.0747 - accuracy: 0.4204
Epoch 2/90
938/938 [==============================] - 8s 9ms/step - loss: 0.0465 - accuracy: 0.6888
Epoch 3/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0344 - accuracy: 0.7817
Epoch 4/90
938/938 [==============================] - 9s 9ms/step - loss: 0.0271 - accuracy: 0.8303
Epoch 5/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0219 - accuracy: 0.8643
Epoch 6/90
938/938 [==============================] - 9s 9ms/step - loss: 0.0189 - accuracy: 0.8818
Epoch 7/90
938/938 [==============================] - 9s 9ms/step - loss: 0.0169 - accuracy: 0.8955
Epoch 8/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0152 - accuracy: 0.9058
Epoch 9/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0149 - accuracy: 0.9076
Epoch 10/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0139 - accuracy: 0.9129
Epoch 11/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0130 - accuracy: 0.9190
Epoch 12/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0128 - accuracy: 0.9202
Epoch 13/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0124 - accuracy: 0.9213
Epoch 14/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0122 - accuracy: 0.9239
Epoch 15/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0121 - accuracy: 0.9233
Epoch 16/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0115 - accuracy: 0.9279
Epoch 17/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0109 - accuracy: 0.9311
Epoch 18/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0110 - accuracy: 0.9312
Epoch 19/90
938/938 [==============================] - 11s 11ms/step - loss: 0.0110 - accuracy: 0.9295
Epoch 20/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0107 - accuracy: 0.9328
Epoch 21/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0108 - accuracy: 0.9316
Epoch 22/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0106 - accuracy: 0.9325
Epoch 23/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0102 - accuracy: 0.9356
Epoch 24/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0105 - accuracy: 0.9338
Epoch 25/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0098 - accuracy: 0.9381
Epoch 26/90
938/938 [==============================] - 11s 11ms/step - loss: 0.0099 - accuracy: 0.9371
Epoch 27/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0096 - accuracy: 0.9392
Epoch 28/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0101 - accuracy: 0.9359
Epoch 29/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0095 - accuracy: 0.9400
Epoch 30/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0095 - accuracy: 0.9399
Epoch 31/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0093 - accuracy: 0.9406
Epoch 32/90
938/938 [==============================] - 11s 12ms/step - loss: 0.0092 - accuracy: 0.9423
Epoch 33/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0093 - accuracy: 0.9403
Epoch 34/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0093 - accuracy: 0.9410
Epoch 35/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0091 - accuracy: 0.9424
Epoch 36/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0090 - accuracy: 0.9424
Epoch 37/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0090 - accuracy: 0.9418
Epoch 38/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0090 - accuracy: 0.9427
Epoch 39/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0087 - accuracy: 0.9452
Epoch 40/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0089 - accuracy: 0.9427
Epoch 41/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0087 - accuracy: 0.9449
Epoch 42/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0088 - accuracy: 0.9444
Epoch 43/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0087 - accuracy: 0.9446
Epoch 44/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0087 - accuracy: 0.9445
Epoch 45/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0089 - accuracy: 0.9432
Epoch 46/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0086 - accuracy: 0.9452
Epoch 47/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0084 - accuracy: 0.9467
Epoch 48/90
938/938 [==============================] - 11s 11ms/step - loss: 0.0086 - accuracy: 0.9452
Epoch 49/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0085 - accuracy: 0.9463
Epoch 50/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0084 - accuracy: 0.9471
Epoch 51/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0083 - accuracy: 0.9467
Epoch 52/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0083 - accuracy: 0.9476
Epoch 53/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0083 - accuracy: 0.9469
Epoch 54/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0083 - accuracy: 0.9475
Epoch 55/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0084 - accuracy: 0.9469
Epoch 56/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0083 - accuracy: 0.9474
Epoch 57/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0081 - accuracy: 0.9489
Epoch 58/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0084 - accuracy: 0.9474
Epoch 59/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0083 - accuracy: 0.9467
Epoch 60/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0080 - accuracy: 0.9486
Epoch 61/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0082 - accuracy: 0.9473
Epoch 62/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0082 - accuracy: 0.9474
Epoch 63/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0083 - accuracy: 0.9461
Epoch 64/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0079 - accuracy: 0.9495
Epoch 65/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0080 - accuracy: 0.9495
Epoch 66/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0081 - accuracy: 0.9485
Epoch 67/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0080 - accuracy: 0.9488
Epoch 68/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0079 - accuracy: 0.9503
Epoch 69/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0081 - accuracy: 0.9485
Epoch 70/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0081 - accuracy: 0.9484
Epoch 71/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0085 - accuracy: 0.9452
Epoch 72/90
938/938 [==============================] - 9s 9ms/step - loss: 0.0081 - accuracy: 0.9485
Epoch 73/90
938/938 [==============================] - 9s 9ms/step - loss: 0.0081 - accuracy: 0.9487
Epoch 74/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0082 - accuracy: 0.9474
Epoch 75/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0081 - accuracy: 0.9481
Epoch 76/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0082 - accuracy: 0.9477
Epoch 77/90
938/938 [==============================] - 9s 9ms/step - loss: 0.0084 - accuracy: 0.9464
Epoch 78/90
938/938 [==============================] - 9s 9ms/step - loss: 0.0081 - accuracy: 0.9490
Epoch 79/90
938/938 [==============================] - 9s 9ms/step - loss: 0.0080 - accuracy: 0.9490
Epoch 80/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0079 - accuracy: 0.9492
Epoch 81/90
938/938 [==============================] - 9s 10ms/step - loss: 0.0079 - accuracy: 0.9493
Epoch 82/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0082 - accuracy: 0.9480
Epoch 83/90
938/938 [==============================] - 11s 11ms/step - loss: 0.0080 - accuracy: 0.9482
Epoch 84/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0079 - accuracy: 0.9495
Epoch 85/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0081 - accuracy: 0.9489
Epoch 86/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0079 - accuracy: 0.9496
Epoch 87/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0078 - accuracy: 0.9502
Epoch 88/90
938/938 [==============================] - 10s 10ms/step - loss: 0.0077 - accuracy: 0.9507
Epoch 89/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0075 - accuracy: 0.9527
Epoch 90/90
938/938 [==============================] - 10s 11ms/step - loss: 0.0075 - accuracy: 0.9531
313/313 [==============================] - 2s 5ms/step - loss: 0.0071 - accuracy: 0.9551
1875/1875 [==============================] - 7s 4ms/step - loss: 0.0071 - accuracy: 0.9551
