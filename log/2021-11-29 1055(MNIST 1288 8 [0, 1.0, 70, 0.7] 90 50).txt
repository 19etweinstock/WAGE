2021-11-29 1055
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 90
batchSize = 50

lr_schedule = [0, 1., 70, 0.7]

loadModel = None
# loadModel = '2021-11-28 2347(MNIST 1288 8 [0, 1.0, 70, 0.7] 90 48)'

[[0, 70], [1.0, 1.0, 0.7]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
conv/qconv2d [5, 5, 1, 6] Scale: 4
conv/qconv2d_1 [5, 5, 6, 8] Scale: 8
fc/qfc [128, 120] Scale: 8
fc/qfc_1 [120, 84] Scale: 8
fc/qfc_2 [84, 10] Scale: 8
CONV: 1350 FC: 26280 TOTAL: 27630
Epoch 1/90
1200/1200 [==============================] - 15s 11ms/step - loss: 0.0707 - accuracy: 0.4587
Epoch 2/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0430 - accuracy: 0.7156
Epoch 3/90
1200/1200 [==============================] - 14s 12ms/step - loss: 0.0314 - accuracy: 0.8026
Epoch 4/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0255 - accuracy: 0.8419
Epoch 5/90
1200/1200 [==============================] - 14s 11ms/step - loss: 0.0216 - accuracy: 0.8664
Epoch 6/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0195 - accuracy: 0.8795
Epoch 7/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0174 - accuracy: 0.8917
Epoch 8/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0160 - accuracy: 0.8997
Epoch 9/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0153 - accuracy: 0.9035
Epoch 10/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0149 - accuracy: 0.9055
Epoch 11/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0142 - accuracy: 0.9104
Epoch 12/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0136 - accuracy: 0.9134
Epoch 13/90
1200/1200 [==============================] - 14s 12ms/step - loss: 0.0132 - accuracy: 0.9161
Epoch 14/90
1200/1200 [==============================] - 14s 12ms/step - loss: 0.0124 - accuracy: 0.9217
Epoch 15/90
1200/1200 [==============================] - 14s 12ms/step - loss: 0.0121 - accuracy: 0.9242
Epoch 16/90
1200/1200 [==============================] - 14s 12ms/step - loss: 0.0118 - accuracy: 0.9257
Epoch 17/90
1200/1200 [==============================] - 14s 11ms/step - loss: 0.0120 - accuracy: 0.9244
Epoch 18/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0120 - accuracy: 0.9236
Epoch 19/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0116 - accuracy: 0.9271
Epoch 20/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0114 - accuracy: 0.9275
Epoch 21/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0112 - accuracy: 0.9290
Epoch 22/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0111 - accuracy: 0.9297
Epoch 23/90
1200/1200 [==============================] - 18s 15ms/step - loss: 0.0108 - accuracy: 0.9318
Epoch 24/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0110 - accuracy: 0.9310
Epoch 25/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0105 - accuracy: 0.9334
Epoch 26/90
1200/1200 [==============================] - 14s 11ms/step - loss: 0.0103 - accuracy: 0.9348
Epoch 27/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0101 - accuracy: 0.9362
Epoch 28/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0099 - accuracy: 0.9375
Epoch 29/90
1200/1200 [==============================] - 14s 12ms/step - loss: 0.0101 - accuracy: 0.9356
Epoch 30/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0098 - accuracy: 0.9380
Epoch 31/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0100 - accuracy: 0.9359
Epoch 32/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0097 - accuracy: 0.9386
Epoch 33/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0094 - accuracy: 0.9397
Epoch 34/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0092 - accuracy: 0.9412
Epoch 35/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0095 - accuracy: 0.9405
Epoch 36/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0094 - accuracy: 0.9399
Epoch 37/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0093 - accuracy: 0.9407
Epoch 38/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0090 - accuracy: 0.9428
Epoch 39/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0089 - accuracy: 0.9433
Epoch 40/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0092 - accuracy: 0.9410
Epoch 41/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0091 - accuracy: 0.9417
Epoch 42/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0090 - accuracy: 0.9427
Epoch 43/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0092 - accuracy: 0.9413
Epoch 44/90
1200/1200 [==============================] - 14s 12ms/step - loss: 0.0089 - accuracy: 0.9433
Epoch 45/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0088 - accuracy: 0.9438
Epoch 46/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0089 - accuracy: 0.9430
Epoch 47/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0087 - accuracy: 0.9446
Epoch 48/90
1200/1200 [==============================] - 14s 11ms/step - loss: 0.0087 - accuracy: 0.9447
Epoch 49/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0085 - accuracy: 0.9459
Epoch 50/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0086 - accuracy: 0.9455
Epoch 51/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0086 - accuracy: 0.9454
Epoch 52/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0087 - accuracy: 0.9445
Epoch 53/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0083 - accuracy: 0.9466
Epoch 54/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0083 - accuracy: 0.9470
Epoch 55/90
1200/1200 [==============================] - 14s 11ms/step - loss: 0.0084 - accuracy: 0.9468
Epoch 56/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0085 - accuracy: 0.9461
Epoch 57/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0082 - accuracy: 0.9475
Epoch 58/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0081 - accuracy: 0.9490
Epoch 59/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0080 - accuracy: 0.9489
Epoch 60/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0081 - accuracy: 0.9487
Epoch 61/90
1200/1200 [==============================] - 13s 10ms/step - loss: 0.0081 - accuracy: 0.9490
Epoch 62/90
1200/1200 [==============================] - 12s 10ms/step - loss: 0.0079 - accuracy: 0.9499
Epoch 63/90
1200/1200 [==============================] - 14s 11ms/step - loss: 0.0080 - accuracy: 0.9493
Epoch 64/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0080 - accuracy: 0.9490
Epoch 65/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0077 - accuracy: 0.9506
Epoch 66/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0079 - accuracy: 0.9493
Epoch 67/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0081 - accuracy: 0.9478
Epoch 68/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0078 - accuracy: 0.9503
Epoch 69/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0078 - accuracy: 0.9510
Epoch 70/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0079 - accuracy: 0.9499
Epoch 71/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0074 - accuracy: 0.9536
Epoch 72/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0075 - accuracy: 0.9530
Epoch 73/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0077 - accuracy: 0.9517
Epoch 74/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0075 - accuracy: 0.9514
Epoch 75/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0075 - accuracy: 0.9519
Epoch 76/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0077 - accuracy: 0.9506
Epoch 77/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0078 - accuracy: 0.9505
Epoch 78/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0078 - accuracy: 0.9500
Epoch 79/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0075 - accuracy: 0.9521
Epoch 80/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0074 - accuracy: 0.9525
Epoch 81/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0075 - accuracy: 0.9522
Epoch 82/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0074 - accuracy: 0.9528
Epoch 83/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0075 - accuracy: 0.9519
Epoch 84/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0075 - accuracy: 0.9526
Epoch 85/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0075 - accuracy: 0.9512
Epoch 86/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0074 - accuracy: 0.9530
Epoch 87/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0072 - accuracy: 0.9534
Epoch 88/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0078 - accuracy: 0.9503
Epoch 89/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0075 - accuracy: 0.9521
Epoch 90/90
1200/1200 [==============================] - 13s 11ms/step - loss: 0.0075 - accuracy: 0.9525
313/313 [==============================] - 2s 5ms/step - loss: 0.0081 - accuracy: 0.9488
1875/1875 [==============================] - 7s 4ms/step - loss: 0.0081 - accuracy: 0.9495
