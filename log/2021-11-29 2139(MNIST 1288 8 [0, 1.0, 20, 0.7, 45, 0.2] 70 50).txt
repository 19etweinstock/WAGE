2021-11-29 2139
LR    = 1
bitsW = 1  # bit width of weights
bitsA = 2 # bit width of activations
bitsG = 8  # bit width of gradients
bitsE = 8 # bit width of errors

bitsR = 8  # bit width of randomizer

Epoch = 70
batchSize = 50

lr_schedule = [0, 1., 20, 0.7, 45, 0.2]

# loadModel = None
loadModel = '2021-11-29 2120(MNIST 1288 8 [0, 1.0, 20, 0.7, 45, 0.2] 70 50)'

[[0, 20, 45], [1.0, 1.0, 0.7, 0.2]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
conv/qconv2d [5, 5, 1, 6] Scale: 4
conv/qconv2d_1 [5, 5, 6, 8] Scale: 8
fc/qfc [128, 120] Scale: 8
fc/qfc_1 [120, 84] Scale: 8
fc/qfc_2 [84, 10] Scale: 8
CONV: 1350 FC: 26280 TOTAL: 27630
Epoch 1/70
1200/1200 [==============================] - 18s 13ms/step - loss: 3.6812 - accuracy: 0.9535 - val_loss: 19.5057 - val_accuracy: 0.9506
Epoch 2/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7441 - accuracy: 0.9519 - val_loss: 18.6795 - val_accuracy: 0.9522
Epoch 3/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7412 - accuracy: 0.9522 - val_loss: 16.7586 - val_accuracy: 0.9579
Epoch 4/70
1200/1200 [==============================] - 16s 14ms/step - loss: 3.8446 - accuracy: 0.9501 - val_loss: 19.0537 - val_accuracy: 0.9512
Epoch 5/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7002 - accuracy: 0.9528 - val_loss: 16.8105 - val_accuracy: 0.9600
Epoch 6/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7083 - accuracy: 0.9530 - val_loss: 22.1971 - val_accuracy: 0.9457
Epoch 7/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.6265 - accuracy: 0.9535 - val_loss: 18.6585 - val_accuracy: 0.9543
Epoch 8/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7429 - accuracy: 0.9525 - val_loss: 16.1667 - val_accuracy: 0.9604
Epoch 9/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6760 - accuracy: 0.9532 - val_loss: 19.3501 - val_accuracy: 0.9531
Epoch 10/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.8743 - accuracy: 0.9512 - val_loss: 17.3600 - val_accuracy: 0.9555
Epoch 11/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7979 - accuracy: 0.9512 - val_loss: 17.6276 - val_accuracy: 0.9576
Epoch 12/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.8445 - accuracy: 0.9510 - val_loss: 15.9170 - val_accuracy: 0.9598
Epoch 13/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.6596 - accuracy: 0.9533 - val_loss: 15.5197 - val_accuracy: 0.9619
Epoch 14/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7929 - accuracy: 0.9521 - val_loss: 19.6194 - val_accuracy: 0.9507
Epoch 15/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7823 - accuracy: 0.9524 - val_loss: 17.1337 - val_accuracy: 0.9566
Epoch 16/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7051 - accuracy: 0.9526 - val_loss: 18.9875 - val_accuracy: 0.9513
Epoch 17/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.8130 - accuracy: 0.9514 - val_loss: 19.3531 - val_accuracy: 0.9501
Epoch 18/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7790 - accuracy: 0.9513 - val_loss: 17.4306 - val_accuracy: 0.9549
Epoch 19/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7146 - accuracy: 0.9527 - val_loss: 15.5460 - val_accuracy: 0.9610
Epoch 20/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.8866 - accuracy: 0.9502 - val_loss: 15.9209 - val_accuracy: 0.9601
Epoch 21/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.8015 - accuracy: 0.9516 - val_loss: 16.7647 - val_accuracy: 0.9590
Epoch 22/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.8140 - accuracy: 0.9515 - val_loss: 17.0052 - val_accuracy: 0.9566
Epoch 23/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6667 - accuracy: 0.9527 - val_loss: 19.7248 - val_accuracy: 0.9508
Epoch 24/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.6810 - accuracy: 0.9532 - val_loss: 19.9875 - val_accuracy: 0.9495
Epoch 25/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7593 - accuracy: 0.9525 - val_loss: 16.8581 - val_accuracy: 0.9573
Epoch 26/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7677 - accuracy: 0.9522 - val_loss: 16.7042 - val_accuracy: 0.9569
Epoch 27/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7309 - accuracy: 0.9515 - val_loss: 17.6787 - val_accuracy: 0.9555
Epoch 28/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.6984 - accuracy: 0.9532 - val_loss: 15.8401 - val_accuracy: 0.9598
Epoch 29/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7244 - accuracy: 0.9525 - val_loss: 17.4903 - val_accuracy: 0.9562
Epoch 30/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.8371 - accuracy: 0.9514 - val_loss: 23.1425 - val_accuracy: 0.9432
Epoch 31/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.8550 - accuracy: 0.9515 - val_loss: 17.4466 - val_accuracy: 0.9561
Epoch 32/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7361 - accuracy: 0.9528 - val_loss: 16.4291 - val_accuracy: 0.9585
Epoch 33/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7685 - accuracy: 0.9521 - val_loss: 17.2754 - val_accuracy: 0.9561
Epoch 34/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7982 - accuracy: 0.9521 - val_loss: 17.9703 - val_accuracy: 0.9551
Epoch 35/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.8727 - accuracy: 0.9503 - val_loss: 19.1972 - val_accuracy: 0.9531
Epoch 36/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.8436 - accuracy: 0.9505 - val_loss: 21.1298 - val_accuracy: 0.9483
Epoch 37/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.9124 - accuracy: 0.9494 - val_loss: 18.0958 - val_accuracy: 0.9531
Epoch 38/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7302 - accuracy: 0.9522 - val_loss: 19.6781 - val_accuracy: 0.9510
Epoch 39/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.6747 - accuracy: 0.9531 - val_loss: 17.8222 - val_accuracy: 0.9553
Epoch 40/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7327 - accuracy: 0.9526 - val_loss: 18.4086 - val_accuracy: 0.9554
Epoch 41/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7851 - accuracy: 0.9514 - val_loss: 16.7910 - val_accuracy: 0.9587
Epoch 42/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.4831 - accuracy: 0.9549 - val_loss: 15.1648 - val_accuracy: 0.9635
Epoch 43/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.5967 - accuracy: 0.9543 - val_loss: 18.2584 - val_accuracy: 0.9540
Epoch 44/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7168 - accuracy: 0.9526 - val_loss: 15.9493 - val_accuracy: 0.9615
Epoch 45/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.6756 - accuracy: 0.9538 - val_loss: 18.6524 - val_accuracy: 0.9568
Epoch 46/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6026 - accuracy: 0.9545 - val_loss: 16.3326 - val_accuracy: 0.9602
Epoch 47/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7038 - accuracy: 0.9528 - val_loss: 16.1739 - val_accuracy: 0.9612
Epoch 48/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7081 - accuracy: 0.9527 - val_loss: 18.7839 - val_accuracy: 0.9539
Epoch 49/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.8362 - accuracy: 0.9505 - val_loss: 17.0990 - val_accuracy: 0.9573
Epoch 50/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7805 - accuracy: 0.9521 - val_loss: 17.9826 - val_accuracy: 0.9552
Epoch 51/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.8037 - accuracy: 0.9510 - val_loss: 17.8237 - val_accuracy: 0.9538
Epoch 52/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.8014 - accuracy: 0.9516 - val_loss: 15.9752 - val_accuracy: 0.9588
Epoch 53/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7020 - accuracy: 0.9529 - val_loss: 20.5581 - val_accuracy: 0.9480
Epoch 54/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6077 - accuracy: 0.9535 - val_loss: 17.2213 - val_accuracy: 0.9559
Epoch 55/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.6381 - accuracy: 0.9543 - val_loss: 14.7090 - val_accuracy: 0.9634
Epoch 56/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.6956 - accuracy: 0.9528 - val_loss: 17.6833 - val_accuracy: 0.9562
Epoch 57/70
1200/1200 [==============================] - 16s 14ms/step - loss: 3.8122 - accuracy: 0.9513 - val_loss: 17.1319 - val_accuracy: 0.9569
Epoch 58/70
1200/1200 [==============================] - 15s 12ms/step - loss: 3.7995 - accuracy: 0.9513 - val_loss: 15.0869 - val_accuracy: 0.9615
Epoch 59/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.8120 - accuracy: 0.9515 - val_loss: 18.1236 - val_accuracy: 0.9564
Epoch 60/70
1200/1200 [==============================] - 16s 13ms/step - loss: 3.7837 - accuracy: 0.9515 - val_loss: 16.5054 - val_accuracy: 0.9594
Epoch 61/70
1200/1200 [==============================] - 15s 13ms/step - loss: 3.7156 - accuracy: 0.9522 - val_loss: 17.2347 - val_accuracy: 0.9592
Epoch 62/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7780 - accuracy: 0.9517 - val_loss: 21.2553 - val_accuracy: 0.9471
Epoch 63/70
1200/1200 [==============================] - 14s 11ms/step - loss: 3.7930 - accuracy: 0.9521 - val_loss: 18.0532 - val_accuracy: 0.9564
Epoch 64/70
1200/1200 [==============================] - 14s 11ms/step - loss: 3.8383 - accuracy: 0.9515 - val_loss: 15.6566 - val_accuracy: 0.9625
Epoch 65/70
1200/1200 [==============================] - 14s 11ms/step - loss: 3.7012 - accuracy: 0.9529 - val_loss: 17.0651 - val_accuracy: 0.9576
Epoch 66/70
1200/1200 [==============================] - 14s 11ms/step - loss: 3.7253 - accuracy: 0.9524 - val_loss: 16.4605 - val_accuracy: 0.9573
Epoch 67/70
1200/1200 [==============================] - 14s 12ms/step - loss: 3.7600 - accuracy: 0.9524 - val_loss: 18.2704 - val_accuracy: 0.9548
Epoch 68/70
1200/1200 [==============================] - 14s 11ms/step - loss: 3.7718 - accuracy: 0.9525 - val_loss: 16.0231 - val_accuracy: 0.9607
Epoch 69/70
1200/1200 [==============================] - 14s 11ms/step - loss: 3.7624 - accuracy: 0.9525 - val_loss: 16.8167 - val_accuracy: 0.9579
Epoch 70/70
1200/1200 [==============================] - 14s 11ms/step - loss: 3.7375 - accuracy: 0.9531 - val_loss: 17.2515 - val_accuracy: 0.9559
313/313 [==============================] - 1s 4ms/step - loss: 1.8957 - accuracy: 0.9635
1875/1875 [==============================] - 8s 4ms/step - loss: 2.0726 - accuracy: 0.9595
