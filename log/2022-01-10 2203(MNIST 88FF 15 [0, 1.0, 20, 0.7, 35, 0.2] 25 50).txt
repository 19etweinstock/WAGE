2022-01-10 2203
LR    = 1
bitsW = 8  # bit width of weights
bitsA = 8 # bit width of activations
bitsG = 15  # bit width of gradients
bitsE = 15 # bit width of errors

bitsR = 15  # bit width of randomizer

loops = 1
Epoch = 25
batchSize = 50

lr_schedule = [0, 1., 20, 0.7, 35, 0.2]

loadModel = None
# loadModel = '2021-12-03 1640(MNIST 1288 8 [0, 1.0, 20, 0.7, 35, 0.2] 50 50)'

[[0, 20, 35], [1.0, 1.0, 0.7, 0.2]]
Model: "lenet5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
qa (qa)                      multiple                  0         
_________________________________________________________________
qconv2d (qconv2d)            multiple                  150       
_________________________________________________________________
maxpool (maxpool)            multiple                  0         
_________________________________________________________________
qactivation (qactivation)    multiple                  0         
_________________________________________________________________
qconv2d_1 (qconv2d)          multiple                  1200      
_________________________________________________________________
maxpool_1 (maxpool)          multiple                  0         
_________________________________________________________________
qactivation_1 (qactivation)  multiple                  0         
_________________________________________________________________
reshape (reshape)            multiple                  0         
_________________________________________________________________
qfc (qfc)                    multiple                  15360     
_________________________________________________________________
qactivation_2 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_1 (qfc)                  multiple                  10080     
_________________________________________________________________
qactivation_3 (qactivation)  multiple                  0         
_________________________________________________________________
qfc_2 (qfc)                  multiple                  840       
_________________________________________________________________
qsoftmax (qsoftmax)          multiple                  0         
=================================================================
Total params: 27,630
Trainable params: 27,630
Non-trainable params: 0
_________________________________________________________________
conv/qconv2d [5, 5, 1, 6] Scale: 1.0
conv/qconv2d_1 [5, 5, 6, 8] Scale: 1.0
fc/qfc [128, 120] Scale: 1.0
fc/qfc_1 [120, 84] Scale: 1.0
fc/qfc_2 [84, 10] Scale: 1.0
CONV: 1350 FC: 26280 TOTAL: 27630
Epoch 1/25
1200/1200 [==============================] - 16s 11ms/step - loss: 46.1709 - accuracy: 0.1716 - val_loss: 224.8532 - val_accuracy: 0.3003
Epoch 2/25
1200/1200 [==============================] - 12s 10ms/step - loss: 42.8490 - accuracy: 0.3648 - val_loss: 212.0950 - val_accuracy: 0.4231
Epoch 3/25
1200/1200 [==============================] - 12s 10ms/step - loss: 40.7285 - accuracy: 0.4351 - val_loss: 202.3052 - val_accuracy: 0.4632
Epoch 4/25
1200/1200 [==============================] - 13s 11ms/step - loss: 39.0549 - accuracy: 0.4705 - val_loss: 194.4639 - val_accuracy: 0.4933
Epoch 5/25
1200/1200 [==============================] - 12s 10ms/step - loss: 37.5306 - accuracy: 0.4956 - val_loss: 186.4749 - val_accuracy: 0.5144
Epoch 6/25
1200/1200 [==============================] - 13s 11ms/step - loss: 36.0257 - accuracy: 0.5153 - val_loss: 178.9913 - val_accuracy: 0.5335
Epoch 7/25
1200/1200 [==============================] - 13s 11ms/step - loss: 34.6528 - accuracy: 0.5316 - val_loss: 172.1609 - val_accuracy: 0.5496
Epoch 8/25
1200/1200 [==============================] - 13s 11ms/step - loss: 33.4077 - accuracy: 0.5464 - val_loss: 166.0794 - val_accuracy: 0.5606
Epoch 9/25
1200/1200 [==============================] - 13s 11ms/step - loss: 32.2809 - accuracy: 0.5570 - val_loss: 160.4857 - val_accuracy: 0.5694
Epoch 10/25
1200/1200 [==============================] - 13s 11ms/step - loss: 31.2529 - accuracy: 0.5683 - val_loss: 155.4189 - val_accuracy: 0.5812
Epoch 11/25
1200/1200 [==============================] - 13s 11ms/step - loss: 30.3290 - accuracy: 0.5784 - val_loss: 150.9223 - val_accuracy: 0.5891
Epoch 12/25
1200/1200 [==============================] - 13s 11ms/step - loss: 29.4888 - accuracy: 0.5876 - val_loss: 146.7725 - val_accuracy: 0.5980
Epoch 13/25
1200/1200 [==============================] - 14s 11ms/step - loss: 28.7154 - accuracy: 0.5960 - val_loss: 143.0246 - val_accuracy: 0.6092
Epoch 14/25
1200/1200 [==============================] - 13s 11ms/step - loss: 27.9781 - accuracy: 0.6044 - val_loss: 139.4110 - val_accuracy: 0.6141
Epoch 15/25
1200/1200 [==============================] - 13s 11ms/step - loss: 27.3247 - accuracy: 0.6100 - val_loss: 136.1986 - val_accuracy: 0.6210
Epoch 16/25
1200/1200 [==============================] - 13s 11ms/step - loss: 26.7024 - accuracy: 0.6161 - val_loss: 133.0105 - val_accuracy: 0.6249
Epoch 17/25
1200/1200 [==============================] - 13s 11ms/step - loss: 26.1244 - accuracy: 0.6214 - val_loss: 130.2910 - val_accuracy: 0.6300
Epoch 18/25
1200/1200 [==============================] - 13s 11ms/step - loss: 25.5788 - accuracy: 0.6256 - val_loss: 127.6910 - val_accuracy: 0.6350
Epoch 19/25
1200/1200 [==============================] - 14s 11ms/step - loss: 25.0862 - accuracy: 0.6294 - val_loss: 125.2608 - val_accuracy: 0.6379
Epoch 20/25
1200/1200 [==============================] - 13s 11ms/step - loss: 24.6350 - accuracy: 0.6334 - val_loss: 123.1561 - val_accuracy: 0.6445
Epoch 21/25
1200/1200 [==============================] - 13s 11ms/step - loss: 24.2407 - accuracy: 0.6370 - val_loss: 121.2179 - val_accuracy: 0.6486
Epoch 22/25
1200/1200 [==============================] - 14s 11ms/step - loss: 23.8437 - accuracy: 0.6415 - val_loss: 119.2654 - val_accuracy: 0.6518
Epoch 23/25
1200/1200 [==============================] - 12s 10ms/step - loss: 23.5097 - accuracy: 0.6450 - val_loss: 117.6389 - val_accuracy: 0.6538
Epoch 24/25
1200/1200 [==============================] - 13s 11ms/step - loss: 23.1902 - accuracy: 0.6494 - val_loss: 116.0047 - val_accuracy: 0.6572
Epoch 25/25
1200/1200 [==============================] - 13s 11ms/step - loss: 22.8903 - accuracy: 0.6525 - val_loss: 114.6801 - val_accuracy: 0.6607
40/40 [==============================] - 0s 5ms/step - loss: 114.6801 - accuracy: 0.6607
235/235 [==============================] - 1s 5ms/step - loss: 116.3952 - accuracy: 0.6543
